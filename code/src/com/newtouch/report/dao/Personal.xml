<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
    "http://www.ibatis.com/dtd/sql-map-2.dtd">
<sqlMap namespace="personal">
	<typeAlias alias="sysbranchcommissionimpl" type="com.newtouch.report.model.vo.Sysbranchcommissionimpl"/>
	
	<sql id="query_head">
		select *
	  	  from (select row_.*, rownum rownum_ 
	  	          from (
	</sql>
	
	<sql id="query_foot">
    	<![CDATA[
				) row_ 
		where rownum < #limit#)
		where rownum_ >= #start#
		]]>	
	</sql>
	<!-- 查询汇总sql开头 -->
	<sql id="query_cityallhead">
    	<![CDATA[
		select 
		sum(g_day_count) g_day_count,sum(g_day_amount) g_day_amount,
		sum(g_day_premium) g_day_premium,sum(g_day_fee) g_day_fee,
       
       case when trunc(sum(newg_day_premium),2) > 0 then '+' || trunc(sum(newg_day_premium),2)
       when trunc(sum(newg_day_premium),2) = 0 then '0' 
       else '' || trunc(sum(newg_day_premium),2)
       end newg_day_premium,
       case when trunc(sum(newg_day_fee),2) > 0 then '+' || trunc(sum(newg_day_fee),2)
       when trunc(sum(newg_day_fee),2) = 0 then '0' 
       else '' || trunc(sum(newg_day_fee),2)
       end newg_day_fee,
       
       sum(g_month_count) g_month_count,sum(g_month_amount) g_month_amount,
       sum(g_month_premium) g_month_premium,sum(g_month_fee) g_month_fee,
       
       case when trunc(sum(newg_month_premium),2) > 0 then '+' || trunc(sum(newg_month_premium),2) 
       when trunc(sum(newg_month_premium),2) = 0 then '0' 
       else '' || trunc(sum(newg_month_premium),2)
       end newg_month_premium,
       case when trunc(sum(newg_month_fee),2) > 0 then '+' || trunc(sum(newg_month_fee),2) 
       when trunc(sum(newg_month_fee),2) = 0 then '0' 
       else '' || trunc(sum(newg_month_fee),2)
       end newg_month_fee,
       
       sum(g_year_count) g_year_count,sum(g_year_amount) g_year_amount,
       sum(g_year_premium) g_year_premium,sum(g_year_fee) g_year_fee,
       
       case when trunc(sum(newg_year_premium),2) > 0 then '+' || trunc(sum(newg_year_premium),2) 
       when trunc(sum(newg_year_premium),2) = 0 then '0' 
       else '' || trunc(sum(newg_year_premium),2)
       end newg_year_premium,
       case when trunc(sum(newg_year_fee),2) > 0 then '+' || trunc(sum(newg_year_fee),2) 
       when trunc(sum(newg_year_fee),2) = 0 then '0' 
       else '' || trunc(sum(newg_year_fee),2)
       end newg_year_fee,
       
       sum(u_day_count) u_day_count,sum(u_day_amount) u_day_amount,
       sum(u_day_premium) u_day_premium,sum(u_day_fee) u_day_fee,
       
       case when trunc(sum(newu_day_premium),2) > 0 then '+' || trunc(sum(newu_day_premium),2) 
       when trunc(sum(newu_day_premium),2) = 0 then '0' 
       else '' || trunc(sum(newu_day_premium),2)
       end newu_day_premium,
       case when trunc(sum(newu_day_fee),2) > 0 then '+' || trunc(sum(newu_day_fee),2) 
       when trunc(sum(newu_day_fee),2) = 0 then '0' 
       else '' || trunc(sum(newu_day_fee),2)
       end newu_day_fee,
       
       sum(u_month_count) u_month_count,sum(u_month_amount) u_month_amount,
       sum(u_month_premium) u_month_premium,sum(u_month_fee) u_month_fee,
       
       case when trunc(sum(newu_month_premium),2) > 0 then '+' || trunc(sum(newu_month_premium),2) 
       when trunc(sum(newu_day_fee),2) = 0 then '0' 
       else '' || trunc(sum(newu_day_fee),2)
       end newu_month_premium,
       case when trunc(sum(newu_month_fee),2) > 0 then '+' || trunc(sum(newu_month_fee),2) 
       when trunc(sum(newu_month_fee),2) = 0 then '0' 
       else '' || trunc(sum(newu_month_fee),2)
       end newu_month_fee,
       
       sum(u_year_count) u_year_count,sum(u_year_amount) u_year_amount,
       sum(u_year_premium) u_year_premium,sum(u_year_fee) u_year_fee,
       
       case when trunc(sum(newu_year_premium),2) > 0 then '+' || trunc(sum(newu_year_premium),2) 
       when trunc(sum(newu_year_premium),2) = 0 then '0' 
       else '' || trunc(sum(newu_year_premium),2)
       end newu_year_premium,
       case when trunc(sum(newu_year_fee),2) > 0 then '+' || trunc(sum(newu_year_fee),2) 
       when trunc(sum(newu_year_fee),2) = 0 then '0' 
       else '' || trunc(sum(newu_year_fee),2)
       end newu_year_fee
       from (
		]]>	
	</sql>
	<!-- 查询汇总sql结尾 -->
	<sql id="query_cityallfoot">
    	<![CDATA[
				)
		]]>	
	</sql>
	
	<!-- 查询分公司付款单 -->
	<sql id="query_all">
	select * from (
	select sys.branch_name,
       sys.branch_id,
       sum(g_day_count) g_day_count,
       sum(g_day_amount) g_day_amount,
       sum(g_day_premium) g_day_premium,
       sum(g_day_fee) g_day_fee,
       case
         when trunc(sum(newg_day_premium), 2) > 0 then
          '+' || trunc(sum(newg_day_premium), 2)
         when trunc(sum(newg_day_premium), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newg_day_premium), 2)
       end newg_day_premium,
       case
         when trunc(sum(newg_day_fee), 2) > 0 then
          '+' || trunc(sum(newg_day_fee), 2)
         when trunc(sum(newg_day_fee), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newg_day_fee), 2)
       end newg_day_fee,
       sum(g_month_count) g_month_count,
       sum(g_month_amount) g_month_amount,
       sum(g_month_premium) g_month_premium,
       sum(g_month_fee) g_month_fee,
       case
         when trunc(sum(newg_month_premium), 2) > 0 then
          '+' || trunc(sum(newg_month_premium), 2)
         when trunc(sum(newg_month_premium), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newg_month_premium), 2)
       end newg_month_premium,
       case
         when trunc(sum(newg_month_fee), 2) > 0 then
          '+' || trunc(sum(newg_month_fee), 2)
         when trunc(sum(newg_month_fee), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newg_month_fee), 2)
       end newg_month_fee,
       sum(g_year_count) g_year_count,
       sum(g_year_amount) g_year_amount,
       sum(g_year_premium) g_year_premium,
       sum(g_year_fee) g_year_fee,
       case
         when trunc(sum(newg_year_premium), 2) > 0 then
          '+' || trunc(sum(newg_year_premium), 2)
         when trunc(sum(newg_year_premium), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newg_year_premium), 2)
       end newg_year_premium,
       case
         when trunc(sum(newg_year_fee), 2) > 0 then
          '+' || trunc(sum(newg_year_fee), 2)
         when trunc(sum(newg_year_fee), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newg_year_fee), 2)
       end newg_year_fee,
       sum(u_day_count) u_day_count,
       sum(u_day_amount) u_day_amount,
       sum(u_day_premium) u_day_premium,
       sum(u_day_fee) u_day_fee,
       case
         when trunc(sum(newu_day_premium), 2) > 0 then
          '+' || trunc(sum(newu_day_premium), 2)
         when trunc(sum(newu_day_premium), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newu_day_premium), 2)
       end newu_day_premium,
       case
         when trunc(sum(newu_day_fee), 2) > 0 then
          '+' || trunc(sum(newu_day_fee), 2)
         when trunc(sum(newu_day_fee), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newu_day_fee), 2)
       end newu_day_fee,
       sum(u_month_count) u_month_count,
       sum(u_month_amount) u_month_amount,
       sum(u_month_premium) u_month_premium,
       sum(u_month_fee) u_month_fee,
       case
         when trunc(sum(newu_month_premium), 2) > 0 then
          '+' || trunc(sum(newu_month_premium), 2)
         when trunc(sum(newu_day_fee), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newu_day_fee), 2)
       end newu_month_premium,
       case
         when trunc(sum(newu_month_fee), 2) > 0 then
          '+' || trunc(sum(newu_month_fee), 2)
         when trunc(sum(newu_month_fee), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newu_month_fee), 2)
       end newu_month_fee,
       sum(u_year_count) u_year_count,
       sum(u_year_amount) u_year_amount,
       sum(u_year_premium) u_year_premium,
       sum(u_year_fee) u_year_fee,
       case
         when trunc(sum(newu_year_premium), 2) > 0 then
          '+' || trunc(sum(newu_year_premium), 2)
         when trunc(sum(newu_year_premium), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newu_year_premium), 2)
       end newu_year_premium,
       case
         when trunc(sum(newu_year_fee), 2) > 0 then
          '+' || trunc(sum(newu_year_fee), 2)
         when trunc(sum(newu_year_fee), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newu_year_fee), 2)
       end newu_year_fee
  from (select a.channel_no,
               a.g_day_count,
               a.g_day_amount,
               a.g_day_premium,
               a.g_day_fee,
               case
                 when (a.g_day_premium - nvl(k.g_day_premium, 0)) > 0 then
                  '+' || (a.g_day_premium - nvl(k.g_day_premium, 0))
                 when (a.g_day_premium - nvl(k.g_day_premium, 0)) = 0 then
                  '0'
                 else
                  '' || (a.g_day_premium - nvl(k.g_day_premium, 0))
               end newg_day_premium,
               case
                 when (a.g_day_fee - nvl(k.g_day_fee, 0)) > 0 then
                  '+' || (a.g_day_fee - nvl(k.g_day_fee, 0))
                 when (a.g_day_fee - nvl(k.g_day_fee, 0)) = 0 then
                  '0'
                 else
                  '' || (a.g_day_fee - nvl(k.g_day_fee, 0))
               end newg_day_fee,
               a.g_month_count,
               a.g_month_amount,
               a.g_month_premium,
               a.g_month_fee,
               case
                 when (a.g_month_premium - nvl(k.g_month_premium, 0)) > 0 then
                  '+' || (a.g_month_premium - nvl(k.g_month_premium, 0))
                 when (a.g_month_premium - nvl(k.g_month_premium, 0)) = 0 then
                  '0'
                 else
                  '' || (a.g_month_premium - nvl(k.g_month_premium, 0))
               end newg_month_premium,
               case
                 when (a.g_month_fee - nvl(k.g_month_fee, 0)) > 0 then
                  '+' || (a.g_month_fee - nvl(k.g_month_fee, 0))
                 when (a.g_month_fee - nvl(k.g_month_fee, 0)) = 0 then
                  '0'
                 else
                  '' || (a.g_month_fee - nvl(k.g_month_fee, 0))
               end newg_month_fee,
               a.g_year_count,
               a.g_year_amount,
               a.g_year_premium,
               a.g_year_fee,
               case
                 when (a.g_year_premium - nvl(k.g_year_premium, 0)) > 0 then
                  '+' || (a.g_year_premium - nvl(k.g_year_premium, 0))
                 when (a.g_year_premium - nvl(k.g_year_premium, 0)) = 0 then
                  '0'
                 else
                  '' || (a.g_year_premium - nvl(k.g_year_premium, 0))
               end newg_year_premium,
               case
                 when (a.g_year_fee - nvl(k.g_year_fee, 0)) > 0 then
                  '+' || (a.g_year_fee - nvl(k.g_year_fee, 0))
                 when (a.g_year_fee - nvl(k.g_year_fee, 0)) = 0 then
                  '0'
                 else
                  '' || (a.g_year_fee - nvl(k.g_year_fee, 0))
               end newg_year_fee,
               a.u_day_count,
               a.u_day_amount,
               a.u_day_premium,
               a.u_day_fee,
               case
                 when (a.u_day_premium - nvl(k.u_day_premium, 0)) > 0 then
                  '+' || (a.u_day_premium - nvl(k.u_day_premium, 0))
                 when (a.u_day_premium - nvl(k.u_day_premium, 0)) = 0 then
                  '0'
                 else
                  '' || (a.u_day_premium - nvl(k.u_day_premium, 0))
               end newu_day_premium,
               case
                 when (a.u_day_fee - nvl(k.u_day_fee, 0)) > 0 then
                  '+' || (a.u_day_fee - nvl(k.u_day_fee, 0))
                 when (a.u_day_fee - nvl(k.u_day_fee, 0)) = 0 then
                  '0'
                 else
                  '' || (a.u_day_fee - nvl(k.u_day_fee, 0))
               end newu_day_fee,
               a.u_month_count,
               a.u_month_amount,
               a.u_month_premium,
               a.u_month_fee,
               case
                 when (a.u_month_premium - nvl(k.u_month_premium, 0)) > 0 then
                  '+' || (a.u_month_premium - nvl(k.u_month_premium, 0))
                 when (a.u_month_premium - nvl(k.u_month_premium, 0)) = 0 then
                  '0'
                 else
                  '' || (a.u_month_premium - nvl(k.u_month_premium, 0))
               end newu_month_premium,
               case
                 when (a.u_month_fee - nvl(k.u_month_fee, 0)) > 0 then
                  '+' || (a.u_month_fee - nvl(k.u_month_fee, 0))
                 when (a.u_month_fee - nvl(k.u_month_fee, 0)) = 0 then
                  '0'
                 else
                  '' || (a.u_month_fee - nvl(k.u_month_fee, 0))
               end newu_month_fee,
               a.u_year_count,
               a.u_year_amount,
               a.u_year_premium,
               a.u_year_fee,
               case
                 when (a.u_year_premium - nvl(k.u_year_premium, 0)) > 0 then
                  '+' || (a.u_year_premium - nvl(k.u_year_premium, 0))
                 when (a.u_year_premium - nvl(k.u_year_premium, 0)) = 0 then
                  '0'
                 else
                  '' || (a.u_year_premium - nvl(k.u_year_premium, 0))
               end newu_year_premium,
               case
                 when (a.u_year_fee - nvl(k.u_year_fee, 0)) > 0 then
                  '+' || (a.u_year_fee - nvl(k.u_year_fee, 0))
                 when (a.u_year_fee - nvl(k.u_year_fee, 0)) = 0 then
                  '0'
                 else
                  '' || (a.u_year_fee - nvl(k.u_year_fee, 0))
               end newu_year_fee
          from PRO_BC_CHANNLE_SUM a left join PRO_BC_CHANNLE_SUM k on a.channel_no = k.channel_no and k.term_date = add_months(#term_date#, -12) and k.date_flag = 'D'
          where a.term_date = #term_date# and a.date_flag = 'D') pro
            left join sys_branch sys on pro.channel_no = sys.channelcode and sys.status = '1'
            where pro.channel_no in
            (select sh.channelcode from  sys_branch sh where  1=1  
            		   and sh.status = '1'
	                   start with sh.branch_id=#branch_id#
	            connect by prior sh.branch_id=sh.branch_parentid  
	            )
            and pro.channel_no in (SELECT channelcode
                          FROM (SELECT DISTINCT branch_id       id,
                                                branch_name     name,
                                                branch_parentid pid,
                                                channelcode
                                  FROM sys_branch t
                                 WHERE t.status = '1'
                                 START WITH t.branch_id IN
                                            (SELECT tda.data_auth_no
                                               FROM t_data_auth tda
                                              WHERE tda.is_half_check IS NULL
                                                AND tda.object_no = #createUser#
                                                AND object_type = 'USER')
                                CONNECT BY PRIOR t.branch_id = branch_parentid))
                                group by sys.branch_name,sys.branch_id,sys.branch_level order by sys.branch_level) A 
                                left join sys_branch B on A.branch_id = B.BRANCH_ID
                 	where B.status = '1' 
                 		<isNotEmpty prepend="and" property="branch_level">
                 			B.branch_level = #branch_level#
                 		</isNotEmpty>
                 		<!-- <isNotEmpty prepend="and" property="branch_level">
							<isEqual property="branch_level" compareValue="0">
								B.branch_level in ('0','1')
							</isEqual>
							<isEqual property="branch_level" compareValue="1">
								B.branch_level in ('1','3')
							</isEqual>
							<isEqual property="branch_level" compareValue="3">
								B.branch_level in ('3','4')
							</isEqual>
						</isNotEmpty>  -->
						order by B.branch_level,A.branch_id
	
	</sql>
	<!-- <sql id="query_all">
	
		select sb.branch_name,
			a.g_day_count,a.g_day_amount,a.g_day_premium,a.g_day_fee,
			
			case when (a.g_day_premium - nvl(k.g_day_premium,0)) > 0 
			   then '+' || (a.g_day_premium-nvl(k.g_day_premium,0))
			 when (a.g_day_premium - nvl(k.g_day_premium, 0)) = 0 then '0'
			 else '' || (a.g_day_premium - nvl(k.g_day_premium, 0))
               end newg_day_premium,
               
            case when (a.g_day_fee - nvl(k.g_day_fee,0)) > 0 
			   then '+' || (a.g_day_fee-nvl(k.g_day_fee,0))
			 	when (a.g_day_fee - nvl(k.g_day_fee, 0)) = 0 then '0'
			 	else '' || (a.g_day_fee - nvl(k.g_day_fee, 0))
               end newg_day_fee,
               
			a.g_month_count,a.g_month_amount,a.g_month_premium,a.g_month_fee,
			
			case when (a.g_month_premium - nvl(k.g_month_premium,0)) > 0 
			   then '+' || (a.g_month_premium-nvl(k.g_month_premium,0))
			   when (a.g_month_premium - nvl(k.g_month_premium, 0)) = 0 then '0'
               else '' || (a.g_month_premium - nvl(k.g_month_premium, 0))
               end newg_month_premium,
               
            case when (a.g_month_fee - nvl(k.g_month_fee,0)) > 0 
			   then '+' || (a.g_month_fee-nvl(k.g_month_fee,0))
			   when (a.g_month_fee - nvl(k.g_month_fee, 0)) = 0 then '0'
               else '' || (a.g_month_fee - nvl(k.g_month_fee, 0))
               end newg_month_fee,
			   
			a.g_year_count,a.g_year_amount,a.g_year_premium,a.g_year_fee,
			
			case when (a.g_year_premium - nvl(k.g_year_premium,0)) > 0 
			   then '+' || (a.g_year_premium-nvl(k.g_year_premium,0))
               when (a.g_year_premium - nvl(k.g_year_premium, 0)) = 0 then '0'
               else '' || (a.g_year_premium - nvl(k.g_year_premium, 0))
               end newg_year_premium,
			
			case when (a.g_year_fee - nvl(k.g_year_fee,0)) > 0 
			   then '+' || (a.g_year_fee-nvl(k.g_year_fee,0))
               when (a.g_year_fee - nvl(k.g_year_fee, 0)) = 0 then '0'
               else '' || (a.g_year_fee - nvl(k.g_year_fee, 0))
               end newg_year_fee,
			
			a.u_day_count,a.u_day_amount,a.u_day_premium,a.u_day_fee,
			
			case when (a.u_day_premium - nvl(k.u_day_premium,0)) > 0 
			   then '+' || (a.u_day_premium-nvl(k.u_day_premium,0))
               when (a.u_day_premium - nvl(k.u_day_premium, 0)) = 0 then '0'
               else '' || (a.u_day_premium - nvl(k.u_day_premium, 0))
               end newu_day_premium,
               
            case when (a.u_day_fee - nvl(k.u_day_fee,0)) > 0 
			   then '+' || (a.u_day_fee-nvl(k.u_day_fee,0))
			   when (a.u_day_fee - nvl(k.u_day_fee, 0)) = 0 then '0'
               else '' || (a.u_day_fee - nvl(k.u_day_fee, 0))
               end newu_day_fee,
			   
			a.u_month_count,a.u_month_amount,a.u_month_premium,a.u_month_fee,
			
			case when (a.u_month_premium - nvl(k.u_month_premium,0)) > 0 
			   then '+' || (a.u_month_premium-nvl(k.u_month_premium,0))
               when (a.u_month_premium - nvl(k.u_month_premium, 0)) = 0 then '0'
               else '' || (a.u_month_premium - nvl(k.u_month_premium, 0))
               end newu_month_premium,
			
			case when (a.u_month_fee - nvl(k.u_month_fee,0)) > 0 
			   then '+' || (a.u_month_fee-nvl(k.u_month_fee,0))
			   when (a.u_month_fee - nvl(k.u_month_fee, 0)) = 0 then '0'
               else '' || (a.u_month_fee - nvl(k.u_month_fee, 0))
               end newu_month_fee,
			   
			a.u_year_count,a.u_year_amount,a.u_year_premium,a.u_year_fee,
			
			case when (a.u_year_premium - nvl(k.u_year_premium,0)) > 0 
			   then '+' || (a.u_year_premium-nvl(k.u_year_premium,0))
			   when (a.u_year_premium - nvl(k.u_year_premium, 0)) = 0 then '0'
               else '' || (a.u_year_premium - nvl(k.u_year_premium, 0))
               end newu_year_premium,
               
            case when (a.u_year_fee - nvl(k.u_year_fee,0)) > 0 
			   then '+' || (a.u_year_fee-nvl(k.u_year_fee,0))
			   when (a.u_year_fee - nvl(k.u_year_fee, 0)) = 0 then '0'
               else '' || (a.u_year_fee - nvl(k.u_year_fee, 0))
               end newu_year_fee
			
			from 
			(
			
			select *
			  from pro_bc_channle_sum
			 where 1=1
			 	and date_flag = 'D'
				<isNotEmpty prepend="and" property="term_date">
					term_date = #term_date#
		 		</isNotEmpty>
		 		<isEmpty prepend="and" property="term_date">
	          		term_date = sysdate
          		</isEmpty>
				 and channel_no in
			       (select channelcode
			          from sys_branch
			         where channelcode is not null
			         start with branch_id=#branch_id#
			        connect by branch_parentid = prior branch_id
			        <isEqual property="branch_id" compareValue="3702">
			        	union all
			        	select channelcode from sys_branch where branch_id='0111'
			        </isEqual>
			        )
			        
			      select 
						(select sum(sum_1.G_DAY_COUNT         ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_DAY_COUNT         ,
						(select sum(sum_1.G_DAY_AMOUNT        ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_DAY_AMOUNT        ,
						(select sum(sum_1.G_DAY_PREMIUM       ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_DAY_PREMIUM       ,
						(select sum(sum_1.G_DAY_FEE           ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_DAY_FEE           ,
						(select sum(sum_1.G_MONTH_COUNT       ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_MONTH_COUNT       ,
						(select sum(sum_1.G_MONTH_AMOUNT      ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_MONTH_AMOUNT      ,
						(select sum(sum_1.G_MONTH_PREMIUM     ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_MONTH_PREMIUM     ,
						(select sum(sum_1.G_MONTH_FEE         ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_MONTH_FEE         ,
						(select sum(sum_1.G_YEAR_COUNT        ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_YEAR_COUNT        ,
						(select sum(sum_1.G_YEAR_AMOUNT       ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_YEAR_AMOUNT       ,
						(select sum(sum_1.G_YEAR_PREMIUM      ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_YEAR_PREMIUM      ,
						(select sum(sum_1.G_YEAR_FEE          ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_YEAR_FEE          ,
						(select sum(sum_1.U_DAY_COUNT         ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_DAY_COUNT         ,
						(select sum(sum_1.U_DAY_AMOUNT        ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_DAY_AMOUNT        ,
						(select sum(sum_1.U_DAY_PREMIUM       ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_DAY_PREMIUM       ,
						(select sum(sum_1.U_DAY_FEE           ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_DAY_FEE           ,
						(select sum(sum_1.U_MONTH_COUNT       ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_MONTH_COUNT       ,
						(select sum(sum_1.U_MONTH_AMOUNT      ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_MONTH_AMOUNT      ,
						(select sum(sum_1.U_MONTH_PREMIUM     ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_MONTH_PREMIUM     ,
						(select sum(sum_1.U_MONTH_FEE         ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_MONTH_FEE         ,
						(select sum(sum_1.U_YEAR_COUNT        ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_YEAR_COUNT        ,
						(select sum(sum_1.U_YEAR_AMOUNT       ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_YEAR_AMOUNT       ,
						(select sum(sum_1.U_YEAR_PREMIUM      ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_YEAR_PREMIUM      ,
						(select sum(sum_1.U_YEAR_FEE          ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_YEAR_FEE          ,
					 b.channelcode CHANNEL_NO,
					 b.branch_name
					 from sys_branch b
					 Start With b.branch_id = #branch_id#
					Connect By Prior b.branch_id = b.branch_parentid
					       and (level = 1 or level = 2)
			        
			        ) a 
			left join (
			
			
			select g_day_premium,
                    g_day_fee,
                    g_month_premium,
                    g_month_fee,
                    g_year_premium,
                    g_year_fee,
                    u_day_premium,
                    u_day_fee,
                    u_month_premium,
                    u_month_fee,
                    u_year_premium,
                    u_year_fee,
                    channel_no
               from pro_bc_channle_sum
              where 1=1
              		and date_flag = 'D'
              	<isNotEmpty prepend="and" property="term_date">
					term_date = add_months(#term_date#, -12)
		 		</isNotEmpty>
		 		<isEmpty prepend="and" property="term_date">
	          		term_date = add_months(sysdate, -12)
          		</isEmpty>
          		
          		select 
						(select sum(sum_1.G_DAY_COUNT         ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_DAY_COUNT         ,
						(select sum(sum_1.G_DAY_AMOUNT        ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_DAY_AMOUNT        ,
						(select sum(sum_1.G_DAY_PREMIUM       ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_DAY_PREMIUM       ,
						(select sum(sum_1.G_DAY_FEE           ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_DAY_FEE           ,
						(select sum(sum_1.G_MONTH_COUNT       ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_MONTH_COUNT       ,
						(select sum(sum_1.G_MONTH_AMOUNT      ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_MONTH_AMOUNT      ,
						(select sum(sum_1.G_MONTH_PREMIUM     ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_MONTH_PREMIUM     ,
						(select sum(sum_1.G_MONTH_FEE         ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_MONTH_FEE         ,
						(select sum(sum_1.G_YEAR_COUNT        ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_YEAR_COUNT        ,
						(select sum(sum_1.G_YEAR_AMOUNT       ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_YEAR_AMOUNT       ,
						(select sum(sum_1.G_YEAR_PREMIUM      ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_YEAR_PREMIUM      ,
						(select sum(sum_1.G_YEAR_FEE          ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_YEAR_FEE          ,
						(select sum(sum_1.U_DAY_COUNT         ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_DAY_COUNT         ,
						(select sum(sum_1.U_DAY_AMOUNT        ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_DAY_AMOUNT        ,
						(select sum(sum_1.U_DAY_PREMIUM       ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_DAY_PREMIUM       ,
						(select sum(sum_1.U_DAY_FEE           ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_DAY_FEE           ,
						(select sum(sum_1.U_MONTH_COUNT       ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_MONTH_COUNT       ,
						(select sum(sum_1.U_MONTH_AMOUNT      ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_MONTH_AMOUNT      ,
						(select sum(sum_1.U_MONTH_PREMIUM     ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_MONTH_PREMIUM     ,
						(select sum(sum_1.U_MONTH_FEE         ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_MONTH_FEE         ,
						(select sum(sum_1.U_YEAR_COUNT        ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_YEAR_COUNT        ,
						(select sum(sum_1.U_YEAR_AMOUNT       ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_YEAR_AMOUNT       ,
						(select sum(sum_1.U_YEAR_PREMIUM      ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_YEAR_PREMIUM      ,
						(select sum(sum_1.U_YEAR_FEE          ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_YEAR_FEE          ,
					 b.channelcode CHANNEL_NO,
					 b.branch_name
					 from sys_branch b
					 Start With b.branch_id = #branch_id#
					Connect By Prior b.branch_id = b.branch_parentid
					       and (level = 1 or level = 2)
          		
          		) k
    		on k.channel_no = a.channel_no        
			left join sys_branch sb on sb.channelcode = a.channel_no
        

    </sql> -->
    
    
    
    <!--查询分公司级别报表所有信息-->
	<select id="querysysbranchcommission" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		<!-- <include refid="query_head"/> -->
		<include refid="query_all"/>
		<!-- <include refid="query_foot"/> -->
	</select>
	
	<select id="querysysbranchcommission1" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
	   select  B.branch_name,
       sum(g_day_count) g_day_count,
       sum(g_day_amount) g_day_amount,
       sum(g_day_premium) g_day_premium,
       sum(g_day_fee) g_day_fee,
       case
         when trunc(sum(newg_day_premium), 2) > 0 then
          '+' || trunc(sum(newg_day_premium), 2)
         when trunc(sum(newg_day_premium), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newg_day_premium), 2)
       end newg_day_premium,
       case
         when trunc(sum(newg_day_fee), 2) > 0 then
          '+' || trunc(sum(newg_day_fee), 2)
         when trunc(sum(newg_day_fee), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newg_day_fee), 2)
       end newg_day_fee,
       sum(g_month_count) g_month_count,
       sum(g_month_amount) g_month_amount,
       sum(g_month_premium) g_month_premium,
       sum(g_month_fee) g_month_fee,
       case
         when trunc(sum(newg_month_premium), 2) > 0 then
          '+' || trunc(sum(newg_month_premium), 2)
         when trunc(sum(newg_month_premium), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newg_month_premium), 2)
       end newg_month_premium,
       case
         when trunc(sum(newg_month_fee), 2) > 0 then
          '+' || trunc(sum(newg_month_fee), 2)
         when trunc(sum(newg_month_fee), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newg_month_fee), 2)
       end newg_month_fee,
       sum(g_year_count) g_year_count,
       sum(g_year_amount) g_year_amount,
       sum(g_year_premium) g_year_premium,
       sum(g_year_fee) g_year_fee,
       case
         when trunc(sum(newg_year_premium), 2) > 0 then
          '+' || trunc(sum(newg_year_premium), 2)
         when trunc(sum(newg_year_premium), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newg_year_premium), 2)
       end newg_year_premium,
       case
         when trunc(sum(newg_year_fee), 2) > 0 then
          '+' || trunc(sum(newg_year_fee), 2)
         when trunc(sum(newg_year_fee), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newg_year_fee), 2)
       end newg_year_fee,
       sum(u_day_count) u_day_count,
       sum(u_day_amount) u_day_amount,
       sum(u_day_premium) u_day_premium,
       sum(u_day_fee) u_day_fee,
       case
         when trunc(sum(newu_day_premium), 2) > 0 then
          '+' || trunc(sum(newu_day_premium), 2)
         when trunc(sum(newu_day_premium), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newu_day_premium), 2)
       end newu_day_premium,
       case
         when trunc(sum(newu_day_fee), 2) > 0 then
          '+' || trunc(sum(newu_day_fee), 2)
         when trunc(sum(newu_day_fee), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newu_day_fee), 2)
       end newu_day_fee,
       sum(u_month_count) u_month_count,
       sum(u_month_amount) u_month_amount,
       sum(u_month_premium) u_month_premium,
       sum(u_month_fee) u_month_fee,
       case
         when trunc(sum(newu_month_premium), 2) > 0 then
          '+' || trunc(sum(newu_month_premium), 2)
         when trunc(sum(newu_day_fee), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newu_day_fee), 2)
       end newu_month_premium,
       case
         when trunc(sum(newu_month_fee), 2) > 0 then
          '+' || trunc(sum(newu_month_fee), 2)
         when trunc(sum(newu_month_fee), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newu_month_fee), 2)
       end newu_month_fee,
       sum(u_year_count) u_year_count,
       sum(u_year_amount) u_year_amount,
       sum(u_year_premium) u_year_premium,
       sum(u_year_fee) u_year_fee,
       case
         when trunc(sum(newu_year_premium), 2) > 0 then
          '+' || trunc(sum(newu_year_premium), 2)
         when trunc(sum(newu_year_premium), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newu_year_premium), 2)
       end newu_year_premium,
       case
         when trunc(sum(newu_year_fee), 2) > 0 then
          '+' || trunc(sum(newu_year_fee), 2)
         when trunc(sum(newu_year_fee), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newu_year_fee), 2)
       end newu_year_fee
  from (select pro.* from (
  select a.channel_no,
               a.g_day_count,
               a.g_day_amount,
               a.g_day_premium,
               a.g_day_fee,
               case
                 when (a.g_day_premium - nvl(k.g_day_premium, 0)) > 0 then
                  '+' || (a.g_day_premium - nvl(k.g_day_premium, 0))
                 when (a.g_day_premium - nvl(k.g_day_premium, 0)) = 0 then
                  '0'
                 else
                  '' || (a.g_day_premium - nvl(k.g_day_premium, 0))
               end newg_day_premium,
               case
                 when (a.g_day_fee - nvl(k.g_day_fee, 0)) > 0 then
                  '+' || (a.g_day_fee - nvl(k.g_day_fee, 0))
                 when (a.g_day_fee - nvl(k.g_day_fee, 0)) = 0 then
                  '0'
                 else
                  '' || (a.g_day_fee - nvl(k.g_day_fee, 0))
               end newg_day_fee,
               a.g_month_count,
               a.g_month_amount,
               a.g_month_premium,
               a.g_month_fee,
               case
                 when (a.g_month_premium - nvl(k.g_month_premium, 0)) > 0 then
                  '+' || (a.g_month_premium - nvl(k.g_month_premium, 0))
                 when (a.g_month_premium - nvl(k.g_month_premium, 0)) = 0 then
                  '0'
                 else
                  '' || (a.g_month_premium - nvl(k.g_month_premium, 0))
               end newg_month_premium,
               case
                 when (a.g_month_fee - nvl(k.g_month_fee, 0)) > 0 then
                  '+' || (a.g_month_fee - nvl(k.g_month_fee, 0))
                 when (a.g_month_fee - nvl(k.g_month_fee, 0)) = 0 then
                  '0'
                 else
                  '' || (a.g_month_fee - nvl(k.g_month_fee, 0))
               end newg_month_fee,
               a.g_year_count,
               a.g_year_amount,
               a.g_year_premium,
               a.g_year_fee,
               case
                 when (a.g_year_premium - nvl(k.g_year_premium, 0)) > 0 then
                  '+' || (a.g_year_premium - nvl(k.g_year_premium, 0))
                 when (a.g_year_premium - nvl(k.g_year_premium, 0)) = 0 then
                  '0'
                 else
                  '' || (a.g_year_premium - nvl(k.g_year_premium, 0))
               end newg_year_premium,
               case
                 when (a.g_year_fee - nvl(k.g_year_fee, 0)) > 0 then
                  '+' || (a.g_year_fee - nvl(k.g_year_fee, 0))
                 when (a.g_year_fee - nvl(k.g_year_fee, 0)) = 0 then
                  '0'
                 else
                  '' || (a.g_year_fee - nvl(k.g_year_fee, 0))
               end newg_year_fee,
               a.u_day_count,
               a.u_day_amount,
               a.u_day_premium,
               a.u_day_fee,
               case
                 when (a.u_day_premium - nvl(k.u_day_premium, 0)) > 0 then
                  '+' || (a.u_day_premium - nvl(k.u_day_premium, 0))
                 when (a.u_day_premium - nvl(k.u_day_premium, 0)) = 0 then
                  '0'
                 else
                  '' || (a.u_day_premium - nvl(k.u_day_premium, 0))
               end newu_day_premium,
               case
                 when (a.u_day_fee - nvl(k.u_day_fee, 0)) > 0 then
                  '+' || (a.u_day_fee - nvl(k.u_day_fee, 0))
                 when (a.u_day_fee - nvl(k.u_day_fee, 0)) = 0 then
                  '0'
                 else
                  '' || (a.u_day_fee - nvl(k.u_day_fee, 0))
               end newu_day_fee,
               a.u_month_count,
               a.u_month_amount,
               a.u_month_premium,
               a.u_month_fee,
               case
                 when (a.u_month_premium - nvl(k.u_month_premium, 0)) > 0 then
                  '+' || (a.u_month_premium - nvl(k.u_month_premium, 0))
                 when (a.u_month_premium - nvl(k.u_month_premium, 0)) = 0 then
                  '0'
                 else
                  '' || (a.u_month_premium - nvl(k.u_month_premium, 0))
               end newu_month_premium,
               case
                 when (a.u_month_fee - nvl(k.u_month_fee, 0)) > 0 then
                  '+' || (a.u_month_fee - nvl(k.u_month_fee, 0))
                 when (a.u_month_fee - nvl(k.u_month_fee, 0)) = 0 then
                  '0'
                 else
                  '' || (a.u_month_fee - nvl(k.u_month_fee, 0))
               end newu_month_fee,
               a.u_year_count,
               a.u_year_amount,
               a.u_year_premium,
               a.u_year_fee,
               case
                 when (a.u_year_premium - nvl(k.u_year_premium, 0)) > 0 then
                  '+' || (a.u_year_premium - nvl(k.u_year_premium, 0))
                 when (a.u_year_premium - nvl(k.u_year_premium, 0)) = 0 then
                  '0'
                 else
                  '' || (a.u_year_premium - nvl(k.u_year_premium, 0))
               end newu_year_premium,
               case
                 when (a.u_year_fee - nvl(k.u_year_fee, 0)) > 0 then
                  '+' || (a.u_year_fee - nvl(k.u_year_fee, 0))
                 when (a.u_year_fee - nvl(k.u_year_fee, 0)) = 0 then
                  '0'
                 else
                  '' || (a.u_year_fee - nvl(k.u_year_fee, 0))
               end newu_year_fee
          from PRO_BC_CHANNLE_SUM1 a left join PRO_BC_CHANNLE_SUM1 k on a.channel_no = k.channel_no and k.term_date = add_months(#term_date#, -12) and k.date_flag = 'D'
          where a.term_date = #term_date# and a.date_flag = 'D') pro
            left join sys_branch sys on pro.channel_no = sys.channelcode and sys.status = '1'
            where pro.channel_no in
              (select sh.channelcode
                 from sys_branch sh
                where 1 = 1
                  and sh.status = '1'
                and sh.branch_id = #branch_id#)
            and pro.channel_no in (SELECT channelcode
                          FROM (SELECT DISTINCT branch_id       id,
                                                branch_name     name,
                                                branch_parentid pid,
                                                channelcode
                                  FROM sys_branch t
                                 WHERE t.status = '1'
                                 START WITH t.branch_id IN
                                            (SELECT tda.data_auth_no
                                               FROM t_data_auth tda
                                              WHERE tda.is_half_check IS NULL
                                                AND tda.object_no = #createUser#
                                                AND object_type = 'USER')
                                CONNECT BY PRIOR t.branch_id = branch_parentid))
                                union all
                               select 
       channel_no,
       sum(g_day_count) g_day_count,
       sum(g_day_amount) g_day_amount,
       sum(g_day_premium) g_day_premium,
       sum(g_day_fee) g_day_fee,
       case
         when trunc(sum(newg_day_premium), 2) > 0 then
          '+' || trunc(sum(newg_day_premium), 2)
         when trunc(sum(newg_day_premium), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newg_day_premium), 2)
       end newg_day_premium,
       case
         when trunc(sum(newg_day_fee), 2) > 0 then
          '+' || trunc(sum(newg_day_fee), 2)
         when trunc(sum(newg_day_fee), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newg_day_fee), 2)
       end newg_day_fee,
       sum(g_month_count) g_month_count,
       sum(g_month_amount) g_month_amount,
       sum(g_month_premium) g_month_premium,
       sum(g_month_fee) g_month_fee,
       case
         when trunc(sum(newg_month_premium), 2) > 0 then
          '+' || trunc(sum(newg_month_premium), 2)
         when trunc(sum(newg_month_premium), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newg_month_premium), 2)
       end newg_month_premium,
       case
         when trunc(sum(newg_month_fee), 2) > 0 then
          '+' || trunc(sum(newg_month_fee), 2)
         when trunc(sum(newg_month_fee), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newg_month_fee), 2)
       end newg_month_fee,
       sum(g_year_count) g_year_count,
       sum(g_year_amount) g_year_amount,
       sum(g_year_premium) g_year_premium,
       sum(g_year_fee) g_year_fee,
       case
         when trunc(sum(newg_year_premium), 2) > 0 then
          '+' || trunc(sum(newg_year_premium), 2)
         when trunc(sum(newg_year_premium), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newg_year_premium), 2)
       end newg_year_premium,
       case
         when trunc(sum(newg_year_fee), 2) > 0 then
          '+' || trunc(sum(newg_year_fee), 2)
         when trunc(sum(newg_year_fee), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newg_year_fee), 2)
       end newg_year_fee,
       sum(u_day_count) u_day_count,
       sum(u_day_amount) u_day_amount,
       sum(u_day_premium) u_day_premium,
       sum(u_day_fee) u_day_fee,
       case
         when trunc(sum(newu_day_premium), 2) > 0 then
          '+' || trunc(sum(newu_day_premium), 2)
         when trunc(sum(newu_day_premium), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newu_day_premium), 2)
       end newu_day_premium,
       case
         when trunc(sum(newu_day_fee), 2) > 0 then
          '+' || trunc(sum(newu_day_fee), 2)
         when trunc(sum(newu_day_fee), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newu_day_fee), 2)
       end newu_day_fee,
       sum(u_month_count) u_month_count,
       sum(u_month_amount) u_month_amount,
       sum(u_month_premium) u_month_premium,
       sum(u_month_fee) u_month_fee,
       case
         when trunc(sum(newu_month_premium), 2) > 0 then
          '+' || trunc(sum(newu_month_premium), 2)
         when trunc(sum(newu_day_fee), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newu_day_fee), 2)
       end newu_month_premium,
       case
         when trunc(sum(newu_month_fee), 2) > 0 then
          '+' || trunc(sum(newu_month_fee), 2)
         when trunc(sum(newu_month_fee), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newu_month_fee), 2)
       end newu_month_fee,
       sum(u_year_count) u_year_count,
       sum(u_year_amount) u_year_amount,
       sum(u_year_premium) u_year_premium,
       sum(u_year_fee) u_year_fee,
       case
         when trunc(sum(newu_year_premium), 2) > 0 then
          '+' || trunc(sum(newu_year_premium), 2)
         when trunc(sum(newu_year_premium), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newu_year_premium), 2)
       end newu_year_premium,
       case
         when trunc(sum(newu_year_fee), 2) > 0 then
          '+' || trunc(sum(newu_year_fee), 2)
         when trunc(sum(newu_year_fee), 2) = 0 then
          '0'
         else
          '' || trunc(sum(newu_year_fee), 2)
       end newu_year_fee
  from (
  select a.channel_no,
               a.g_day_count,
               a.g_day_amount,
               a.g_day_premium,
               a.g_day_fee,
               case
                 when (a.g_day_premium - nvl(k.g_day_premium, 0)) > 0 then
                  '+' || (a.g_day_premium - nvl(k.g_day_premium, 0))
                 when (a.g_day_premium - nvl(k.g_day_premium, 0)) = 0 then
                  '0'
                 else
                  '' || (a.g_day_premium - nvl(k.g_day_premium, 0))
               end newg_day_premium,
               case
                 when (a.g_day_fee - nvl(k.g_day_fee, 0)) > 0 then
                  '+' || (a.g_day_fee - nvl(k.g_day_fee, 0))
                 when (a.g_day_fee - nvl(k.g_day_fee, 0)) = 0 then
                  '0'
                 else
                  '' || (a.g_day_fee - nvl(k.g_day_fee, 0))
               end newg_day_fee,
               a.g_month_count,
               a.g_month_amount,
               a.g_month_premium,
               a.g_month_fee,
               case
                 when (a.g_month_premium - nvl(k.g_month_premium, 0)) > 0 then
                  '+' || (a.g_month_premium - nvl(k.g_month_premium, 0))
                 when (a.g_month_premium - nvl(k.g_month_premium, 0)) = 0 then
                  '0'
                 else
                  '' || (a.g_month_premium - nvl(k.g_month_premium, 0))
               end newg_month_premium,
               case
                 when (a.g_month_fee - nvl(k.g_month_fee, 0)) > 0 then
                  '+' || (a.g_month_fee - nvl(k.g_month_fee, 0))
                 when (a.g_month_fee - nvl(k.g_month_fee, 0)) = 0 then
                  '0'
                 else
                  '' || (a.g_month_fee - nvl(k.g_month_fee, 0))
               end newg_month_fee,
               a.g_year_count,
               a.g_year_amount,
               a.g_year_premium,
               a.g_year_fee,
               case
                 when (a.g_year_premium - nvl(k.g_year_premium, 0)) > 0 then
                  '+' || (a.g_year_premium - nvl(k.g_year_premium, 0))
                 when (a.g_year_premium - nvl(k.g_year_premium, 0)) = 0 then
                  '0'
                 else
                  '' || (a.g_year_premium - nvl(k.g_year_premium, 0))
               end newg_year_premium,
               case
                 when (a.g_year_fee - nvl(k.g_year_fee, 0)) > 0 then
                  '+' || (a.g_year_fee - nvl(k.g_year_fee, 0))
                 when (a.g_year_fee - nvl(k.g_year_fee, 0)) = 0 then
                  '0'
                 else
                  '' || (a.g_year_fee - nvl(k.g_year_fee, 0))
               end newg_year_fee,
               a.u_day_count,
               a.u_day_amount,
               a.u_day_premium,
               a.u_day_fee,
               case
                 when (a.u_day_premium - nvl(k.u_day_premium, 0)) > 0 then
                  '+' || (a.u_day_premium - nvl(k.u_day_premium, 0))
                 when (a.u_day_premium - nvl(k.u_day_premium, 0)) = 0 then
                  '0'
                 else
                  '' || (a.u_day_premium - nvl(k.u_day_premium, 0))
               end newu_day_premium,
               case
                 when (a.u_day_fee - nvl(k.u_day_fee, 0)) > 0 then
                  '+' || (a.u_day_fee - nvl(k.u_day_fee, 0))
                 when (a.u_day_fee - nvl(k.u_day_fee, 0)) = 0 then
                  '0'
                 else
                  '' || (a.u_day_fee - nvl(k.u_day_fee, 0))
               end newu_day_fee,
               a.u_month_count,
               a.u_month_amount,
               a.u_month_premium,
               a.u_month_fee,
               case
                 when (a.u_month_premium - nvl(k.u_month_premium, 0)) > 0 then
                  '+' || (a.u_month_premium - nvl(k.u_month_premium, 0))
                 when (a.u_month_premium - nvl(k.u_month_premium, 0)) = 0 then
                  '0'
                 else
                  '' || (a.u_month_premium - nvl(k.u_month_premium, 0))
               end newu_month_premium,
               case
                 when (a.u_month_fee - nvl(k.u_month_fee, 0)) > 0 then
                  '+' || (a.u_month_fee - nvl(k.u_month_fee, 0))
                 when (a.u_month_fee - nvl(k.u_month_fee, 0)) = 0 then
                  '0'
                 else
                  '' || (a.u_month_fee - nvl(k.u_month_fee, 0))
               end newu_month_fee,
               a.u_year_count,
               a.u_year_amount,
               a.u_year_premium,
               a.u_year_fee,
               case
                 when (a.u_year_premium - nvl(k.u_year_premium, 0)) > 0 then
                  '+' || (a.u_year_premium - nvl(k.u_year_premium, 0))
                 when (a.u_year_premium - nvl(k.u_year_premium, 0)) = 0 then
                  '0'
                 else
                  '' || (a.u_year_premium - nvl(k.u_year_premium, 0))
               end newu_year_premium,
               case
                 when (a.u_year_fee - nvl(k.u_year_fee, 0)) > 0 then
                  '+' || (a.u_year_fee - nvl(k.u_year_fee, 0))
                 when (a.u_year_fee - nvl(k.u_year_fee, 0)) = 0 then
                  '0'
                 else
                  '' || (a.u_year_fee - nvl(k.u_year_fee, 0))
               end newu_year_fee
          from PRO_BC_CHANNLE_SUM a left join PRO_BC_CHANNLE_SUM k on a.channel_no = k.channel_no and k.term_date = add_months(#term_date#, -12) and k.date_flag = 'D'
          where a.term_date = #term_date# and a.date_flag = 'D') pro
            left join sys_branch sys on pro.channel_no = sys.channelcode and sys.status = '1'
            where  pro.channel_no in
              (select sh.channelcode
                 from sys_branch sh
                where 1 = 1
                  and sh.status = '1'
                start with sh.branch_id in
                           (select branch_id
                              from sys_branch
                             where branch_parentid = #branch_id#
                               and status = '1'
                               and branch_level != #branch_level#
                               and branch_level != '1')
               connect by prior sh.branch_id = sh.branch_parentid)
            and pro.channel_no in (SELECT channelcode
                          FROM (SELECT DISTINCT branch_id       id,
                                                branch_name     name,
                                                branch_parentid pid,
                                                channelcode
                                  FROM sys_branch t
                                 WHERE t.status = '1'
                                 START WITH t.branch_id IN
                                            (SELECT tda.data_auth_no
                                               FROM t_data_auth tda
                                              WHERE tda.is_half_check IS NULL
                                                AND tda.object_no = #createUser#
                                                AND object_type = 'USER')
                                CONNECT BY PRIOR t.branch_id = branch_parentid))
                                group by channel_no) A,(select branch_name
                                      from sys_branch
                                     where branch_id = #branch_id#
                                       and status = '1') B 
 group by B.branch_name order by B.branch_name
                                
	</select>
	
	<!-- 查询分公司级别报表页数 -->
	<select id="sysbranchcommissioncount" parameterClass="sysbranchcommissionimpl" resultClass="int">
		select count(*) from (
		<include refid="query_all"/>
		)
	</select>
	
	
	
	
	
	
    
    
    <!-- 查询分公司付款单 -->
	<sql id="query_all_month">
	
		select sb.branch_name,
			a.g_day_count,a.g_day_amount,a.g_day_premium,a.g_day_fee,
			
			case when (a.g_day_premium - nvl(k.g_day_premium,0)) > 0 
			   then '+' || (a.g_day_premium-nvl(k.g_day_premium,0))
			 when (a.g_day_premium - nvl(k.g_day_premium, 0)) = 0 then '0'
			 else '' || (a.g_day_premium - nvl(k.g_day_premium, 0))
               end newg_day_premium,
               
            case when (a.g_day_fee - nvl(k.g_day_fee,0)) > 0 
			   then '+' || (a.g_day_fee-nvl(k.g_day_fee,0))
			 	when (a.g_day_fee - nvl(k.g_day_fee, 0)) = 0 then '0'
			 	else '' || (a.g_day_fee - nvl(k.g_day_fee, 0))
               end newg_day_fee,
               
			a.g_month_count,a.g_month_amount,a.g_month_premium,a.g_month_fee,
			
			case when (a.g_month_premium - nvl(k.g_month_premium,0)) > 0 
			   then '+' || (a.g_month_premium-nvl(k.g_month_premium,0))
			   when (a.g_month_premium - nvl(k.g_month_premium, 0)) = 0 then '0'
               else '' || (a.g_month_premium - nvl(k.g_month_premium, 0))
               end newg_month_premium,
               
            case when (a.g_month_fee - nvl(k.g_month_fee,0)) > 0 
			   then '+' || (a.g_month_fee-nvl(k.g_month_fee,0))
			   when (a.g_month_fee - nvl(k.g_month_fee, 0)) = 0 then '0'
               else '' || (a.g_month_fee - nvl(k.g_month_fee, 0))
               end newg_month_fee,
			   
			a.g_year_count,a.g_year_amount,a.g_year_premium,a.g_year_fee,
			
			case when (a.g_year_premium - nvl(k.g_year_premium,0)) > 0 
			   then '+' || (a.g_year_premium-nvl(k.g_year_premium,0))
               when (a.g_year_premium - nvl(k.g_year_premium, 0)) = 0 then '0'
               else '' || (a.g_year_premium - nvl(k.g_year_premium, 0))
               end newg_year_premium,
			
			case when (a.g_year_fee - nvl(k.g_year_fee,0)) > 0 
			   then '+' || (a.g_year_fee-nvl(k.g_year_fee,0))
               when (a.g_year_fee - nvl(k.g_year_fee, 0)) = 0 then '0'
               else '' || (a.g_year_fee - nvl(k.g_year_fee, 0))
               end newg_year_fee,
			
			a.u_day_count,a.u_day_amount,a.u_day_premium,a.u_day_fee,
			
			case when (a.u_day_premium - nvl(k.u_day_premium,0)) > 0 
			   then '+' || (a.u_day_premium-nvl(k.u_day_premium,0))
               when (a.u_day_premium - nvl(k.u_day_premium, 0)) = 0 then '0'
               else '' || (a.u_day_premium - nvl(k.u_day_premium, 0))
               end newu_day_premium,
               
            case when (a.u_day_fee - nvl(k.u_day_fee,0)) > 0 
			   then '+' || (a.u_day_fee-nvl(k.u_day_fee,0))
			   when (a.u_day_fee - nvl(k.u_day_fee, 0)) = 0 then '0'
               else '' || (a.u_day_fee - nvl(k.u_day_fee, 0))
               end newu_day_fee,
			   
			a.u_month_count,a.u_month_amount,a.u_month_premium,a.u_month_fee,
			
			case when (a.u_month_premium - nvl(k.u_month_premium,0)) > 0 
			   then '+' || (a.u_month_premium-nvl(k.u_month_premium,0))
               when (a.u_month_premium - nvl(k.u_month_premium, 0)) = 0 then '0'
               else '' || (a.u_month_premium - nvl(k.u_month_premium, 0))
               end newu_month_premium,
			
			case when (a.u_month_fee - nvl(k.u_month_fee,0)) > 0 
			   then '+' || (a.u_month_fee-nvl(k.u_month_fee,0))
			   when (a.u_month_fee - nvl(k.u_month_fee, 0)) = 0 then '0'
               else '' || (a.u_month_fee - nvl(k.u_month_fee, 0))
               end newu_month_fee,
			   
			a.u_year_count,a.u_year_amount,a.u_year_premium,a.u_year_fee,
			
			case when (a.u_year_premium - nvl(k.u_year_premium,0)) > 0 
			   then '+' || (a.u_year_premium-nvl(k.u_year_premium,0))
			   when (a.u_year_premium - nvl(k.u_year_premium, 0)) = 0 then '0'
               else '' || (a.u_year_premium - nvl(k.u_year_premium, 0))
               end newu_year_premium,
               
            case when (a.u_year_fee - nvl(k.u_year_fee,0)) > 0 
			   then '+' || (a.u_year_fee-nvl(k.u_year_fee,0))
			   when (a.u_year_fee - nvl(k.u_year_fee, 0)) = 0 then '0'
               else '' || (a.u_year_fee - nvl(k.u_year_fee, 0))
               end newu_year_fee
			
			from 
			(
			
			<!-- select *
			  from pro_bc_channle_sum
			 where 1=1
			 and date_flag = 'M'
				<isNotEmpty prepend="and" property="term_date">
					term_date = trunc(add_months(TO_DATE(#term_date#, 'yyyy-mm-dd'), +1) ,'mm')
		 		</isNotEmpty>
		 		<isEmpty prepend="and" property="term_date">
	          		term_date = trunc(add_months(TO_DATE(sysdate, 'yyyy-mm-dd'), +1) ,'mm')
          		</isEmpty>
				 and channel_no in
			       (select channelcode
			          from sys_branch
			         where channelcode is not null
			         start with branch_id=#branch_id#
			        connect by branch_parentid = prior branch_id
			        <isEqual property="branch_id" compareValue="3702">
			        	union all
			        	select channelcode from sys_branch where branch_id='0111'
			        </isEqual>
			        ) -->
			        
			        select 
						(select sum(sum_1.G_DAY_COUNT         ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_DAY_COUNT         ,
						(select sum(sum_1.G_DAY_AMOUNT        ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_DAY_AMOUNT        ,
						(select sum(sum_1.G_DAY_PREMIUM       ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_DAY_PREMIUM       ,
						(select sum(sum_1.G_DAY_FEE           ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_DAY_FEE           ,
						(select sum(sum_1.G_MONTH_COUNT       ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_MONTH_COUNT       ,
						(select sum(sum_1.G_MONTH_AMOUNT      ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_MONTH_AMOUNT      ,
						(select sum(sum_1.G_MONTH_PREMIUM     ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_MONTH_PREMIUM     ,
						(select sum(sum_1.G_MONTH_FEE         ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_MONTH_FEE         ,
						(select sum(sum_1.G_YEAR_COUNT        ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_YEAR_COUNT        ,
						(select sum(sum_1.G_YEAR_AMOUNT       ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_YEAR_AMOUNT       ,
						(select sum(sum_1.G_YEAR_PREMIUM      ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_YEAR_PREMIUM      ,
						(select sum(sum_1.G_YEAR_FEE          ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_YEAR_FEE          ,
						(select sum(sum_1.U_DAY_COUNT         ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_DAY_COUNT         ,
						(select sum(sum_1.U_DAY_AMOUNT        ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_DAY_AMOUNT        ,
						(select sum(sum_1.U_DAY_PREMIUM       ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_DAY_PREMIUM       ,
						(select sum(sum_1.U_DAY_FEE           ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_DAY_FEE           ,
						(select sum(sum_1.U_MONTH_COUNT       ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_MONTH_COUNT       ,
						(select sum(sum_1.U_MONTH_AMOUNT      ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_MONTH_AMOUNT      ,
						(select sum(sum_1.U_MONTH_PREMIUM     ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_MONTH_PREMIUM     ,
						(select sum(sum_1.U_MONTH_FEE         ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_MONTH_FEE         ,
						(select sum(sum_1.U_YEAR_COUNT        ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_YEAR_COUNT        ,
						(select sum(sum_1.U_YEAR_AMOUNT       ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_YEAR_AMOUNT       ,
						(select sum(sum_1.U_YEAR_PREMIUM      ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_YEAR_PREMIUM      ,
						(select sum(sum_1.U_YEAR_FEE          ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_YEAR_FEE          ,
					 b.channelcode CHANNEL_NO,
					 b.branch_name
					 from sys_branch b
					 Start With b.branch_id = #branch_id#
					Connect By Prior b.branch_id = b.branch_parentid
					       and (level = #branch_level# or level = (#branch_level#+1))
			        
			        
			        ) a 
			left join (
			
			<!-- select g_day_premium,
                    g_day_fee,
                    g_month_premium,
                    g_month_fee,
                    g_year_premium,
                    g_year_fee,
                    u_day_premium,
                    u_day_fee,
                    u_month_premium,
                    u_month_fee,
                    u_year_premium,
                    u_year_fee,
                    channel_no
               from pro_bc_channle_sum
               and date_flag = 'M'
              where 1=1
              	<isNotEmpty prepend="and" property="term_date">
					term_date = trunc(add_months(TO_DATE(#term_date#, 'yyyy-mm-dd'), -11) ,'mm')
		 		</isNotEmpty>
		 		<isEmpty prepend="and" property="term_date">
	          		term_date = trunc(add_months(TO_DATE(sysdate, 'yyyy-mm-dd'), -11) ,'mm')
          		</isEmpty> -->
          		select 
						(select sum(sum_1.G_DAY_COUNT         ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_DAY_COUNT         ,
						(select sum(sum_1.G_DAY_AMOUNT        ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_DAY_AMOUNT        ,
						(select sum(sum_1.G_DAY_PREMIUM       ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_DAY_PREMIUM       ,
						(select sum(sum_1.G_DAY_FEE           ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_DAY_FEE           ,
						(select sum(sum_1.G_MONTH_COUNT       ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_MONTH_COUNT       ,
						(select sum(sum_1.G_MONTH_AMOUNT      ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_MONTH_AMOUNT      ,
						(select sum(sum_1.G_MONTH_PREMIUM     ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_MONTH_PREMIUM     ,
						(select sum(sum_1.G_MONTH_FEE         ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_MONTH_FEE         ,
						(select sum(sum_1.G_YEAR_COUNT        ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_YEAR_COUNT        ,
						(select sum(sum_1.G_YEAR_AMOUNT       ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_YEAR_AMOUNT       ,
						(select sum(sum_1.G_YEAR_PREMIUM      ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_YEAR_PREMIUM      ,
						(select sum(sum_1.G_YEAR_FEE          ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) G_YEAR_FEE          ,
						(select sum(sum_1.U_DAY_COUNT         ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_DAY_COUNT         ,
						(select sum(sum_1.U_DAY_AMOUNT        ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_DAY_AMOUNT        ,
						(select sum(sum_1.U_DAY_PREMIUM       ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_DAY_PREMIUM       ,
						(select sum(sum_1.U_DAY_FEE           ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_DAY_FEE           ,
						(select sum(sum_1.U_MONTH_COUNT       ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_MONTH_COUNT       ,
						(select sum(sum_1.U_MONTH_AMOUNT      ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_MONTH_AMOUNT      ,
						(select sum(sum_1.U_MONTH_PREMIUM     ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_MONTH_PREMIUM     ,
						(select sum(sum_1.U_MONTH_FEE         ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_MONTH_FEE         ,
						(select sum(sum_1.U_YEAR_COUNT        ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_YEAR_COUNT        ,
						(select sum(sum_1.U_YEAR_AMOUNT       ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_YEAR_AMOUNT       ,
						(select sum(sum_1.U_YEAR_PREMIUM      ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_YEAR_PREMIUM      ,
						(select sum(sum_1.U_YEAR_FEE          ) g_day_count  from pro_bc_channle_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = b.branch_id Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid )) U_YEAR_FEE          ,
					 b.channelcode CHANNEL_NO,
					 b.branch_name
					 from sys_branch b
					 Start With b.branch_id = #branch_id#
					Connect By Prior b.branch_id = b.branch_parentid
					       and (level = #branch_level# or level = (#branch_level#+1))
          		
          		) k
    		on k.channel_no = a.channel_no        
			left join sys_branch sb on sb.channelcode = a.channel_no

    </sql>
    
    
    <!--查询分公司级别报表所有信息-->
	<select id="querysysbranch_monthcommission" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		<include refid="query_head"/>
		<include refid="query_all_month"/>
		<include refid="query_foot"/>
	</select>
	
	<!-- 查询分公司级别报表页数 -->
	<select id="sysbranch_monthcommissioncount" parameterClass="sysbranchcommissionimpl" resultClass="int">
		select count(*) from (
		<include refid="query_all_month"/>
		)
	</select>
    
    
    
    
	
	
	<!-- 查询集团付款单 -->
	<sql id="query_allcity">
	select branch_id,branch_name,
       sum(g_day_count) g_day_count,sum(g_day_amount) g_day_amount,
       sum(g_day_premium) g_day_premium,sum(g_day_fee) g_day_fee,
       
       case when trunc(sum(newg_day_premium),2) > 0 then '+' || trunc(sum(newg_day_premium),2)
       when trunc(sum(newg_day_premium),2) = 0 then '0'
       else '' || trunc(sum(newg_day_premium),2)
       end newg_day_premium,
       case when trunc(sum(newg_day_fee),2) > 0 then '+' || trunc(sum(newg_day_fee),2) 
       when trunc(sum(newg_day_fee),2) = 0 then '0'
       else '' || trunc(sum(newg_day_fee),2)
       end newg_day_fee,
       
       sum(g_month_count) g_month_count,sum(g_month_amount) g_month_amount,
       sum(g_month_premium) g_month_premium,sum(g_month_fee) g_month_fee,
       
       case when trunc(sum(newg_month_premium),2) > 0 then '+' || trunc(sum(newg_month_premium),2) 
       when trunc(sum(newg_month_premium),2) = 0 then '0'
       else '' || trunc(sum(newg_month_premium),2)
       end newg_month_premium,
       case when trunc(sum(newg_month_fee),2) > 0 then '+' || trunc(sum(newg_month_fee),2) 
       when trunc(sum(newg_month_fee),2) = 0 then '0'
       else '' || trunc(sum(newg_month_fee),2)
       end newg_month_fee,
       
       sum(g_year_count) g_year_count,sum(g_year_amount) g_year_amount,
       sum(g_year_premium) g_year_premium,sum(g_year_fee) g_year_fee,
       
       case when trunc(sum(newg_year_premium),2) > 0 then '+' || trunc(sum(newg_year_premium),2) 
       when trunc(sum(newg_year_premium),2) = 0 then '0'
       else '' || trunc(sum(newg_year_premium),2)
       end newg_year_premium,
       case when trunc(sum(newg_year_fee),2) > 0 then '+' || trunc(sum(newg_year_fee),2) 
       when trunc(sum(newg_year_fee),2) = 0 then '0'
       else '' || trunc(sum(newg_year_fee),2)
       end newg_year_fee,
       
       sum(u_day_count) u_day_count,sum(u_day_amount) u_day_amount,
       sum(u_day_premium) u_day_premium,sum(u_day_fee) u_day_fee,
       
       case when trunc(sum(newu_day_premium),2) > 0 then '+' || trunc(sum(newu_day_premium),2) 
       when trunc(sum(newu_day_premium),2) = 0 then '0'
       else '' || trunc(sum(newu_day_premium),2)
       end newu_day_premium,
       case when trunc(sum(newu_day_fee),2) > 0 then '+' || trunc(sum(newu_day_fee),2) 
       when trunc(sum(newu_day_fee),2) = 0 then '0'
       else '' || trunc(sum(newu_day_fee),2)
       end newu_day_fee,
       
       sum(u_month_count) u_month_count,sum(u_month_amount) u_month_amount,
       sum(u_month_premium) u_month_premium,sum(u_month_fee) u_month_fee,
       
       case when trunc(sum(newu_month_premium),2) > 0 then '+' || trunc(sum(newu_month_premium),2) 
       when trunc(sum(newu_month_premium),2) = 0 then '0'
       else '' || trunc(sum(newu_month_premium),2)
       end newu_month_premium,
       case when trunc(sum(newu_month_fee),2) > 0 then '+' || trunc(sum(newu_month_fee),2) 
       when trunc(sum(newu_month_fee),2) = 0 then '0'
       else '' || trunc(sum(newu_month_fee),2)
       end newu_month_fee,
       
       sum(u_year_count) u_year_count,sum(u_year_amount) u_year_amount,
       sum(u_year_premium) u_year_premium,sum(u_year_fee) u_year_fee,
       
       case when trunc(sum(newu_year_premium),2) > 0 then '+' || trunc(sum(newu_year_premium),2) 
       when trunc(sum(newu_year_premium),2) = 0 then '0'
       else '' || trunc(sum(newu_year_premium),2)
       end newu_year_premium,
       case when trunc(sum(newu_year_fee),2) > 0 then '+' || trunc(sum(newu_year_fee),2) 
       when trunc(sum(newu_year_fee),2) = 0 then '0'
       else '' || trunc(sum(newu_year_fee),2)
       end newu_year_fee
		from 
			(select 
				(select branch_id
                          from sys_branch m
                         where branch_level = '1'
                         start with m.channelcode = a.channel_no
                        connect by prior m.branch_parentid = m.branch_id) branch_id,
                 (select  branch_name
                          from sys_branch m
                         where branch_level = '1'
                         start with m.channelcode = a.channel_no
                        connect by prior m.branch_parentid = m.branch_id) branch_name,
               	a.g_day_count,
               	a.g_day_amount,
               	a.g_day_premium,
               	a.g_day_fee,
               	a.g_day_premium - nvl(k.g_day_premium, 0) newg_day_premium,
                a.g_day_fee - nvl(k.g_day_fee, 0) newg_day_fee,
                a.g_month_count,
                a.g_month_amount,
                a.g_month_premium,
                a.g_month_fee,
                a.g_month_premium - nvl(k.g_month_premium, 0) newg_month_premium,
                a.g_month_fee - nvl(k.g_month_fee, 0) newg_month_fee,
                a.g_year_count,
                a.g_year_amount,
                a.g_year_premium,
                a.g_year_fee,
                a.g_year_premium - nvl(k.g_year_premium, 0) newg_year_premium,
                a.g_year_fee - nvl(k.g_year_fee, 0) newg_year_fee,
                a.u_day_count,
                a.u_day_amount,
                a.u_day_premium,
                a.u_day_fee,
                a.u_day_premium - nvl(k.u_day_premium, 0) newu_day_premium,
                a.u_day_fee - nvl(k.u_day_fee, 0) newu_day_fee,
                a.u_month_count,
                a.u_month_amount,
                a.u_month_premium,
                a.u_month_fee,
                a.u_month_premium - nvl(k.u_month_premium, 0) newu_month_premium,
                a.u_month_fee - nvl(k.u_month_fee, 0) newu_month_fee,
                a.u_year_count,
                a.u_year_amount,
                a.u_year_premium,
                a.u_year_fee,
                a.u_year_premium - nvl(k.u_year_premium, 0) newu_year_premium,
                a.u_year_fee - nvl(k.u_year_fee, 0) newu_year_fee
          		from 
          			(select * from pro_bc_channle_sum
                		where 1=1
                		<isNotEmpty prepend="and" property="term_date">
							term_date = #term_date#
				 		</isNotEmpty>
				 		<isEmpty prepend="and" property="term_date">
			          		term_date = sysdate
		          		</isEmpty>
                		and channel_no in 
                			(select channelcode from sys_branch 
                				where channelcode is not null start with branch_id = #branch_id#
                					connect by branch_parentid = prior  branch_id)
                			<!-- <isEqual property="branch_id" compareValue="3702">
					        	union all
					        	select channelcode from sys_branch where branch_id='0111'
					        </isEqual> -->		
                	) a
                left join (select g_day_premium,
                    g_day_fee,
                    g_month_premium,
                    g_month_fee,
                    g_year_premium,
                    g_year_fee,
                    u_day_premium,
                    u_day_fee,
                    u_month_premium,
                    u_month_fee,
                    u_year_premium,
                    u_year_fee,
                    channel_no
               from pro_bc_channle_sum
              where 1=1
              <isNotEmpty prepend="and" property="term_date">
					term_date = add_months(#term_date#, -12)
		 		</isNotEmpty>
		 		<isEmpty prepend="and" property="term_date">
	          		term_date = add_months(sysdate, -12)
          		</isEmpty>) k
    		on k.channel_no = a.channel_no
    		)
 	group by branch_id, branch_name
	

    </sql>
    
    <!--查询集团报表所有信息-->
	<select id="querycitycommission" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		<include refid="query_head"/>
		<include refid="query_allcity"/>
		<include refid="query_foot"/>
	</select>
	
	<!-- 查询集团报表页数 -->
	<select id="citycommissioncount" parameterClass="sysbranchcommissionimpl" resultClass="int">
		select count(*) from (
		<include refid="query_allcity"/>
		)
	</select>
	<!-- 查询部门级别报表 -->
	<select id="querydepartcommission" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		select sb.branch_name,
			a.g_day_count,a.g_day_amount,a.g_day_premium,a.g_day_fee,
       case
         when (a.g_day_premium - nvl(k.g_day_premium, 0)) > 0 then  '+' || (a.g_day_premium - nvl(k.g_day_premium, 0))
         when (a.g_day_premium - nvl(k.g_day_premium, 0)) = 0 then '0'
         else '' || (a.g_day_premium - nvl(k.g_day_premium, 0))
         end newg_day_premium,
       case
         when (a.g_day_fee - nvl(k.g_day_fee, 0)) > 0 then  '+' || (a.g_day_fee - nvl(k.g_day_fee, 0))
         when (a.g_day_fee - nvl(k.g_day_fee, 0)) = 0 then '0'
         else '' || (a.g_day_fee - nvl(k.g_day_fee, 0))
       	 end newg_day_fee,
       		a.g_month_count,a.g_month_amount,a.g_month_premium,a.g_month_fee,
       case
         when (a.g_month_premium - nvl(k.g_month_premium, 0)) > 0 then '+' || (a.g_month_premium - nvl(k.g_month_premium, 0))
         when (a.g_month_premium - nvl(k.g_month_premium, 0)) = 0 then '0'
         else '' || (a.g_month_premium - nvl(k.g_month_premium, 0))
       	 end newg_month_premium,
       case
         when (a.g_month_fee - nvl(k.g_month_fee, 0)) > 0 then  '+' || (a.g_month_fee - nvl(k.g_month_fee, 0))
         when (a.g_month_fee - nvl(k.g_month_fee, 0)) = 0 then '0'
         else '' || (a.g_month_fee - nvl(k.g_month_fee, 0))
         end newg_month_fee,
       		a.g_year_count,a.g_year_amount,a.g_year_premium,a.g_year_fee,
       case
         when (a.g_year_premium - nvl(k.g_year_premium, 0)) > 0 then '+' || (a.g_year_premium - nvl(k.g_year_premium, 0))
         when (a.g_year_premium - nvl(k.g_year_premium, 0)) = 0 then '0'
         else '' || (a.g_year_premium - nvl(k.g_year_premium, 0))
         end newg_year_premium,
       case
         when (a.g_year_fee - nvl(k.g_year_fee, 0)) > 0 then '+' || (a.g_year_fee - nvl(k.g_year_fee, 0))
         when (a.g_year_fee - nvl(k.g_year_fee, 0)) = 0 then '0'
         else '' || (a.g_year_fee - nvl(k.g_year_fee, 0))
         end newg_year_fee,
       		a.u_day_count,a.u_day_amount,a.u_day_premium,a.u_day_fee,
       case
         when (a.u_day_premium - nvl(k.u_day_premium, 0)) > 0 then '+' || (a.u_day_premium - nvl(k.u_day_premium, 0))
         when (a.u_day_premium - nvl(k.u_day_premium, 0)) = 0 then '0'
         else '' || (a.u_day_premium - nvl(k.u_day_premium, 0))
         end newu_day_premium,
       case
         when (a.u_day_fee - nvl(k.u_day_fee, 0)) > 0 then  '+' || (a.u_day_fee - nvl(k.u_day_fee, 0))
         when (a.u_day_fee - nvl(k.u_day_fee, 0)) = 0 then '0'
         else '' || (a.u_day_fee - nvl(k.u_day_fee, 0))
         end newu_day_fee,
       		a.u_month_count,a.u_month_amount,a.u_month_premium,a.u_month_fee,
       case
         when (a.u_month_premium - nvl(k.u_month_premium, 0)) > 0 then '+' || (a.u_month_premium - nvl(k.u_month_premium, 0))
         when (a.u_month_premium - nvl(k.u_month_premium, 0)) = 0 then '0'
         else '' || (a.u_month_premium - nvl(k.u_month_premium, 0))
         end newu_month_premium,
       case
         when (a.u_month_fee - nvl(k.u_month_fee, 0)) > 0 then '+' || (a.u_month_fee - nvl(k.u_month_fee, 0))
         when (a.u_month_fee - nvl(k.u_month_fee, 0)) = 0 then '0'
         else '' || (a.u_month_fee - nvl(k.u_month_fee, 0))
         end newu_month_fee,
       		a.u_year_count,a.u_year_amount,a.u_year_premium,a.u_year_fee,
       case
         when (a.u_year_premium - nvl(k.u_year_premium, 0)) > 0 then '+' || (a.u_year_premium - nvl(k.u_year_premium, 0))
         when (a.u_year_premium - nvl(k.u_year_premium, 0)) = 0 then '0'
         else '' || (a.u_year_premium - nvl(k.u_year_premium, 0))
       	 end newu_year_premium,
       case
         when (a.u_year_fee - nvl(k.u_year_fee, 0)) > 0 then  '+' || (a.u_year_fee - nvl(k.u_year_fee, 0))
         when (a.u_year_fee - nvl(k.u_year_fee, 0)) = 0 then '0'
         else '' || (a.u_year_fee - nvl(k.u_year_fee, 0))
         end newu_year_fee
			from 
			(select *
			  from pro_bc_channle_sum
			 where 1=1
				<isNotEmpty prepend="and" property="term_date">
					term_date = #term_date#
		 		</isNotEmpty>
		 		<isEmpty prepend="and" property="term_date">
	          		term_date = sysdate
          		</isEmpty>
				and channel_no = (select channelcode from sys_branch where branch_id=#branch_id#)) a 
				left join (select g_day_premium,
                    g_day_fee,
                    g_month_premium,
                    g_month_fee,
                    g_year_premium,
                    g_year_fee,
                    u_day_premium,
                    u_day_fee,
                    u_month_premium,
                    u_month_fee,
                    u_year_premium,
                    u_year_fee,
                    channel_no
               from pro_bc_channle_sum
              where 1=1
              <isNotEmpty prepend="and" property="term_date">
					term_date = add_months(#term_date#, -12)
		 		</isNotEmpty>
		 		<isEmpty prepend="and" property="term_date">
	          		term_date = add_months(sysdate, -12)
          		</isEmpty>) k
    		on k.channel_no = a.channel_no
			left join sys_branch sb on sb.channelcode = a.channel_no
        
	</select>
	
	<!--查询分公司汇总-->
	<select id="collectbranch" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		<include refid="query_cityallhead"/>
		<include refid="query_all"/>
		<include refid="query_cityallfoot"/>
	</select>
	
	<!--查询分公司汇总-->
	<select id="collectbranch_month" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		<include refid="query_cityallhead"/>
		<include refid="query_all_month"/>
		<include refid="query_cityallfoot"/>
	</select>
	
	<!--查询集团汇总-->
	<select id="collectcity" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		<include refid="query_cityallhead"/>
		<include refid="query_allcity"/>
		<include refid="query_cityallfoot"/>
	</select>
	
	<!--导出集团报表-->
	<select id="downloadcitycommission" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		<include refid="query_allcity"/>
	</select>
	
	<!--导出分公司报表-->
	<select id="downloadsysbranchcommission" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		<include refid="query_all"/>
	</select>
	
	<!--导出分公司报表-->
	<select id="downloadsysbranch_monthcommission" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		<include refid="query_all_month"/>
	</select>
	
	<!-- 代理查询主干 -->
	<sql id="query_allagency">
		<!-- select * from ( -->
			select repair_coding,agency_name branch_name,<!-- channel_no, -->
		       sum(g_day_count) g_day_count,sum(g_day_amount) g_day_amount,
		       sum(g_day_premium) g_day_premium,sum(g_day_fee) g_day_fee,
		       
		       case when trunc(sum(newg_day_premium), 2) > 0 then '+' || trunc(sum(newg_day_premium), 2)
		       		when trunc(sum(newg_day_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_day_premium), 2)
		        	end newg_day_premium,
		       case when trunc(sum(newg_day_fee), 2) > 0 then '+' || trunc(sum(newg_day_fee), 2) 
		       		when trunc(sum(newg_day_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_day_fee), 2)
		       		end newg_day_fee,
		       
		       sum(g_month_count) g_month_count, sum(g_month_amount) g_month_amount,
		       sum(g_month_premium) g_month_premium, sum(g_month_fee) g_month_fee,
		       
		       case when trunc(sum(newg_month_premium), 2) > 0 then '+' || trunc(sum(newg_month_premium), 2) 
		       		when trunc(sum(newg_month_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_month_premium), 2)
		       		end newg_month_premium,
		       case when trunc(sum(newg_month_fee), 2) > 0 then '+' || trunc(sum(newg_month_fee), 2) 
		       		when trunc(sum(newg_month_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_month_fee), 2)
		       		end newg_month_fee,
		       
		       sum(g_year_count) g_year_count, sum(g_year_amount) g_year_amount,
		       sum(g_year_premium) g_year_premium, sum(g_year_fee) g_year_fee,
		       
		       case when trunc(sum(newg_year_premium), 2) > 0 then '+' || trunc(sum(newg_year_premium), 2) 
		       		when trunc(sum(newg_year_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_year_premium), 2)
		       		end newg_year_premium,
		       case when trunc(sum(newg_year_fee), 2) > 0 then '+' || trunc(sum(newg_year_fee), 2) 
		       		when trunc(sum(newg_year_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_year_fee), 2)
		       		end newg_year_fee,
		       
		       sum(u_day_count) u_day_count, sum(u_day_amount) u_day_amount,
		       sum(u_day_premium) u_day_premium, sum(u_day_fee) u_day_fee,
		       
		       case when trunc(sum(newu_day_premium), 2) > 0 then '+' || trunc(sum(newu_day_premium), 2) 
		       		when trunc(sum(newu_day_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_day_premium), 2)
		       		end newu_day_premium,
		       case when trunc(sum(newu_day_fee), 2) > 0 then '+' || trunc(sum(newu_day_fee), 2) 
		       		when trunc(sum(newu_day_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_day_fee), 2)
		       		end newu_day_fee,
		       
		       sum(u_month_count) u_month_count, sum(u_month_amount) u_month_amount,
		       sum(u_month_premium) u_month_premium, sum(u_month_fee) u_month_fee,
		       
		       case when trunc(sum(newu_month_premium), 2) > 0 then '+' || trunc(sum(newu_month_premium), 2) 
		       		when trunc(sum(newu_month_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_month_premium), 2)
		       		end newu_month_premium,
		       case when trunc(sum(newu_month_fee), 2) > 0 then '+' || trunc(sum(newu_month_fee), 2) 
		       		when trunc(sum(newu_month_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_month_fee), 2)
		       		end newu_month_fee,
		       
		       sum(u_year_count) u_year_count, sum(u_year_amount) u_year_amount,
		       sum(u_year_premium) u_year_premium, sum(u_year_fee) u_year_fee,
		       
		       case when trunc(sum(newu_year_premium), 2) > 0 then '+' || trunc(sum(newu_year_premium), 2) 
		       		when trunc(sum(newu_year_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_year_premium), 2)
		       		end newu_year_premium,
		       case when trunc(sum(newu_year_fee), 2) > 0 then '+' || trunc(sum(newu_year_fee), 2) 
		       		when trunc(sum(newu_year_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_year_fee), 2)
		       		end newu_year_fee
		  from (
		         select a.agency_name,a.repair_coding,a.channel_no,
		                a.g_day_count,a.g_day_amount,a.g_day_premium,a.g_day_fee,
		                a.g_day_premium - nvl(k.g_day_premium, 0) newg_day_premium,
		                a.g_day_fee - nvl(k.g_day_fee, 0) newg_day_fee,
		                a.g_month_count,a.g_month_amount,a.g_month_premium,a.g_month_fee,
		                a.g_month_premium - nvl(k.g_month_premium, 0) newg_month_premium,
		                a.g_month_fee - nvl(k.g_month_fee, 0) newg_month_fee,
		                a.g_year_count,a.g_year_amount,a.g_year_premium,a.g_year_fee,
		                a.g_year_premium - nvl(k.g_year_premium, 0) newg_year_premium,
		                a.g_year_fee - nvl(k.g_year_fee, 0) newg_year_fee,
		                a.u_day_count,a.u_day_amount,a.u_day_premium,a.u_day_fee,
		                a.u_day_premium - nvl(k.u_day_premium, 0) newu_day_premium,
		                a.u_day_fee - nvl(k.u_day_fee, 0) newu_day_fee,
		                a.u_month_count,a.u_month_amount,a.u_month_premium,a.u_month_fee,
		                a.u_month_premium - nvl(k.u_month_premium, 0) newu_month_premium,
		                a.u_month_fee - nvl(k.u_month_fee, 0) newu_month_fee,
		                a.u_year_count,a.u_year_amount,a.u_year_premium,a.u_year_fee,
		                a.u_year_premium - nvl(k.u_year_premium, 0) newu_year_premium,
		                a.u_year_fee - nvl(k.u_year_fee, 0) newu_year_fee
		          from (select * from pro_bc_agency_sum
		                  where 1=1 and repair_coding is not null 
		                  	<isNotEmpty prepend="and" property="term_date">
								term_date = #term_date#
					 		</isNotEmpty>
					 		<isEmpty prepend="and" property="term_date">
				          		term_date = sysdate
			          		</isEmpty>
		                    and channel_no in
		                        (select channelcode from sys_branch
		                          where channelcode is not null start with branch_id = #branch_id#
		                         connect by branch_parentid = prior branch_id
		                         <!-- <isEqual property="branch_id" compareValue="3702">
						        	union all
						        	select channelcode from sys_branch where branch_id='0111'
						         </isEqual> -->
		                         )
		               ) a
		          left join (select g_day_premium,g_day_fee,
		                            g_month_premium,g_month_fee,
		                            g_year_premium,g_year_fee,
		                            u_day_premium,u_day_fee,
		                            u_month_premium,u_month_fee,
		                            u_year_premium,u_year_fee,
		                            channel_no,repair_coding,agency_name
		                       from pro_bc_agency_sum
		                      where 1=1 and repair_coding is not null 
		                      	<isNotEmpty prepend="and" property="term_date">
									term_date = add_months(#term_date#, -12)
						 		</isNotEmpty>
						 		<isEmpty prepend="and" property="term_date">
					          		term_date = add_months(sysdate, -12)
				          		</isEmpty>
				          		and channel_no in
		                        (select channelcode from sys_branch
		                          where channelcode is not null start with branch_id = #branch_id#
		                         connect by branch_parentid = prior branch_id
		                         <!-- <isEqual property="branch_id" compareValue="3702">
						        	union all
						        	select channelcode from sys_branch where branch_id='0111'
						         </isEqual> -->)
		                      ) k
		            on k.channel_no = a.channel_no
		            and k.repair_coding = a.repair_coding
		            and k.agency_name = a.agency_name
		            where 1=1 and a.channel_no in (SELECT channelcode
                          FROM (SELECT DISTINCT branch_id       id,
                                                branch_name     name,
                                                branch_parentid pid,
                                                channelcode
                                  FROM sys_branch t
                                 WHERE t.status = '1'
                                 START WITH t.branch_id IN
                                            (SELECT tda.data_auth_no
                                               FROM t_data_auth tda
                                              WHERE tda.is_half_check IS NULL
                                                AND tda.object_no = #createUser#
                                                AND object_type = 'USER')
                                CONNECT BY PRIOR t.branch_id = branch_parentid))
                    
		        )
 			group by repair_coding, agency_name <!-- ,channel_no) A 
 			left join sys_branch B on A.channel_no = B.Channelcode where status = '1'
                <isNotEmpty prepend="and" property="branch_level">
					<isEqual property="branch_level" compareValue="0">
						B.branch_level in ('0','1')
					</isEqual>
					<isEqual property="branch_level" compareValue="1">
						B.branch_level in ('1','3')
					</isEqual>
					<isEqual property="branch_level" compareValue="3">
						B.branch_level in ('3','4')
					</isEqual>
				</isNotEmpty> 
				order by B.branch_level -->
			union all 
			select repair_coding,'其他' branch_name,<!-- channel_no, -->
		       sum(g_day_count) g_day_count,sum(g_day_amount) g_day_amount,
		       sum(g_day_premium) g_day_premium,sum(g_day_fee) g_day_fee,
		       
		       case when trunc(sum(newg_day_premium), 2) > 0 then '+' || trunc(sum(newg_day_premium), 2)
		       		when trunc(sum(newg_day_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_day_premium), 2)
		        	end newg_day_premium,
		       case when trunc(sum(newg_day_fee), 2) > 0 then '+' || trunc(sum(newg_day_fee), 2) 
		       		when trunc(sum(newg_day_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_day_fee), 2)
		       		end newg_day_fee,
		       
		       sum(g_month_count) g_month_count, sum(g_month_amount) g_month_amount,
		       sum(g_month_premium) g_month_premium, sum(g_month_fee) g_month_fee,
		       
		       case when trunc(sum(newg_month_premium), 2) > 0 then '+' || trunc(sum(newg_month_premium), 2) 
		       		when trunc(sum(newg_month_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_month_premium), 2)
		       		end newg_month_premium,
		       case when trunc(sum(newg_month_fee), 2) > 0 then '+' || trunc(sum(newg_month_fee), 2) 
		       		when trunc(sum(newg_month_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_month_fee), 2)
		       		end newg_month_fee,
		       
		       sum(g_year_count) g_year_count, sum(g_year_amount) g_year_amount,
		       sum(g_year_premium) g_year_premium, sum(g_year_fee) g_year_fee,
		       
		       case when trunc(sum(newg_year_premium), 2) > 0 then '+' || trunc(sum(newg_year_premium), 2) 
		       		when trunc(sum(newg_year_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_year_premium), 2)
		       		end newg_year_premium,
		       case when trunc(sum(newg_year_fee), 2) > 0 then '+' || trunc(sum(newg_year_fee), 2) 
		       		when trunc(sum(newg_year_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_year_fee), 2)
		       		end newg_year_fee,
		       
		       sum(u_day_count) u_day_count, sum(u_day_amount) u_day_amount,
		       sum(u_day_premium) u_day_premium, sum(u_day_fee) u_day_fee,
		       
		       case when trunc(sum(newu_day_premium), 2) > 0 then '+' || trunc(sum(newu_day_premium), 2) 
		       		when trunc(sum(newu_day_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_day_premium), 2)
		       		end newu_day_premium,
		       case when trunc(sum(newu_day_fee), 2) > 0 then '+' || trunc(sum(newu_day_fee), 2) 
		       		when trunc(sum(newu_day_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_day_fee), 2)
		       		end newu_day_fee,
		       
		       sum(u_month_count) u_month_count, sum(u_month_amount) u_month_amount,
		       sum(u_month_premium) u_month_premium, sum(u_month_fee) u_month_fee,
		       
		       case when trunc(sum(newu_month_premium), 2) > 0 then '+' || trunc(sum(newu_month_premium), 2) 
		       		when trunc(sum(newu_month_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_month_premium), 2)
		       		end newu_month_premium,
		       case when trunc(sum(newu_month_fee), 2) > 0 then '+' || trunc(sum(newu_month_fee), 2) 
		       		when trunc(sum(newu_month_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_month_fee), 2)
		       		end newu_month_fee,
		       
		       sum(u_year_count) u_year_count, sum(u_year_amount) u_year_amount,
		       sum(u_year_premium) u_year_premium, sum(u_year_fee) u_year_fee,
		       
		       case when trunc(sum(newu_year_premium), 2) > 0 then '+' || trunc(sum(newu_year_premium), 2) 
		       		when trunc(sum(newu_year_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_year_premium), 2)
		       		end newu_year_premium,
		       case when trunc(sum(newu_year_fee), 2) > 0 then '+' || trunc(sum(newu_year_fee), 2) 
		       		when trunc(sum(newu_year_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_year_fee), 2)
		       		end newu_year_fee
		  from (
		         select a.repair_coding,a.channel_no,
		                a.g_day_count,a.g_day_amount,a.g_day_premium,a.g_day_fee,
		                a.g_day_premium - nvl(k.g_day_premium, 0) newg_day_premium,
		                a.g_day_fee - nvl(k.g_day_fee, 0) newg_day_fee,
		                a.g_month_count,a.g_month_amount,a.g_month_premium,a.g_month_fee,
		                a.g_month_premium - nvl(k.g_month_premium, 0) newg_month_premium,
		                a.g_month_fee - nvl(k.g_month_fee, 0) newg_month_fee,
		                a.g_year_count,a.g_year_amount,a.g_year_premium,a.g_year_fee,
		                a.g_year_premium - nvl(k.g_year_premium, 0) newg_year_premium,
		                a.g_year_fee - nvl(k.g_year_fee, 0) newg_year_fee,
		                a.u_day_count,a.u_day_amount,a.u_day_premium,a.u_day_fee,
		                a.u_day_premium - nvl(k.u_day_premium, 0) newu_day_premium,
		                a.u_day_fee - nvl(k.u_day_fee, 0) newu_day_fee,
		                a.u_month_count,a.u_month_amount,a.u_month_premium,a.u_month_fee,
		                a.u_month_premium - nvl(k.u_month_premium, 0) newu_month_premium,
		                a.u_month_fee - nvl(k.u_month_fee, 0) newu_month_fee,
		                a.u_year_count,a.u_year_amount,a.u_year_premium,a.u_year_fee,
		                a.u_year_premium - nvl(k.u_year_premium, 0) newu_year_premium,
		                a.u_year_fee - nvl(k.u_year_fee, 0) newu_year_fee
		          from (select * from pro_bc_agency_sum
		                  where 1=1 and repair_coding is null 
		                  	<isNotEmpty prepend="and" property="term_date">
								term_date = #term_date#
					 		</isNotEmpty>
					 		<isEmpty prepend="and" property="term_date">
				          		term_date = sysdate
			          		</isEmpty>
		                    and channel_no in
		                        (select channelcode from sys_branch
		                          where channelcode is not null start with branch_id = #branch_id#
		                         connect by branch_parentid = prior branch_id
		                         <!-- <isEqual property="branch_id" compareValue="3702">
						        	union all
						        	select channelcode from sys_branch where branch_id='0111'
						         </isEqual> -->
		                         )
		               ) a
		          left join (select g_day_premium,g_day_fee,
		                            g_month_premium,g_month_fee,
		                            g_year_premium,g_year_fee,
		                            u_day_premium,u_day_fee,
		                            u_month_premium,u_month_fee,
		                            u_year_premium,u_year_fee,
		                            channel_no,repair_coding
		                       from pro_bc_agency_sum
		                      where 1=1 and repair_coding is null 
		                      	<isNotEmpty prepend="and" property="term_date">
									term_date = add_months(#term_date#, -12)
						 		</isNotEmpty>
						 		<isEmpty prepend="and" property="term_date">
					          		term_date = add_months(sysdate, -12)
				          		</isEmpty>
				          		and channel_no in
		                        (select channelcode from sys_branch
		                          where channelcode is not null start with branch_id = #branch_id#
		                         connect by branch_parentid = prior branch_id
		                         <!-- <isEqual property="branch_id" compareValue="3702">
						        	union all
						        	select channelcode from sys_branch where branch_id='0111'
						         </isEqual> -->)
		                      ) k
		            on k.channel_no = a.channel_no
		            where 1=1 and a.channel_no in (SELECT channelcode
                          FROM (SELECT DISTINCT branch_id       id,
                                                branch_name     name,
                                                branch_parentid pid,
                                                channelcode
                                  FROM sys_branch t
                                 WHERE t.status = '1'
                                 START WITH t.branch_id IN
                                            (SELECT tda.data_auth_no
                                               FROM t_data_auth tda
                                              WHERE tda.is_half_check IS NULL
                                                AND tda.object_no = #createUser#
                                                AND object_type = 'USER')
                                CONNECT BY PRIOR t.branch_id = branch_parentid))
                    
		        )
 			group by repair_coding
			
    </sql>
    
    <!--查询代理报表所有信息-->
	<select id="querysysagencycommission" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		<include refid="query_head"/>
		<include refid="query_allagency"/>
		<include refid="query_foot"/>
	</select>
	
	<!-- 查询代理报表页数 -->
	<select id="sysagencycommissioncount" parameterClass="sysbranchcommissionimpl" resultClass="int">
		select count(*) from (
		<include refid="query_allagency"/>
		)
	</select>
	
	<!--查询代理汇总-->
	<select id="collectagency" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		<include refid="query_cityallhead"/>
		<include refid="query_allagency"/>
		<include refid="query_cityallfoot"/>
	</select>
	
	<!--查询代理下载-->
	<select id="downloadagencycommission" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		<include refid="query_allagency"/>
	</select>
	
	
	<!--查询全险种下载-->
	<sql id="query_allinsurance">
			select insurance_type_no,insurance_type_name branch_name,<!-- channel_no, -->
		       sum(g_day_count) g_day_count,sum(g_day_amount) g_day_amount,
		       sum(g_day_premium) g_day_premium,sum(g_day_fee) g_day_fee,
		       
		       case when trunc(sum(newg_day_premium), 2) > 0 then '+' || trunc(sum(newg_day_premium), 2)
		       		when trunc(sum(newg_day_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_day_premium), 2)
		        	end newg_day_premium,
		       case when trunc(sum(newg_day_fee), 2) > 0 then '+' || trunc(sum(newg_day_fee), 2) 
		       		when trunc(sum(newg_day_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_day_fee), 2)
		       		end newg_day_fee,
		       
		       sum(g_month_count) g_month_count, sum(g_month_amount) g_month_amount,
		       sum(g_month_premium) g_month_premium, sum(g_month_fee) g_month_fee,
		       
		       case when trunc(sum(newg_month_premium), 2) > 0 then '+' || trunc(sum(newg_month_premium), 2) 
		       		when trunc(sum(newg_month_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_month_premium), 2)
		       		end newg_month_premium,
		       case when trunc(sum(newg_month_fee), 2) > 0 then '+' || trunc(sum(newg_month_fee), 2) 
		       		when trunc(sum(newg_month_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_month_fee), 2)
		       		end newg_month_fee,
		       
		       sum(g_year_count) g_year_count, sum(g_year_amount) g_year_amount,
		       sum(g_year_premium) g_year_premium, sum(g_year_fee) g_year_fee,
		       
		       case when trunc(sum(newg_year_premium), 2) > 0 then '+' || trunc(sum(newg_year_premium), 2) 
		       		when trunc(sum(newg_year_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_year_premium), 2)
		       		end newg_year_premium,
		       case when trunc(sum(newg_year_fee), 2) > 0 then '+' || trunc(sum(newg_year_fee), 2) 
		       		when trunc(sum(newg_year_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_year_fee), 2)
		       		end newg_year_fee,
		       
		       sum(u_day_count) u_day_count, sum(u_day_amount) u_day_amount,
		       sum(u_day_premium) u_day_premium, sum(u_day_fee) u_day_fee,
		       
		       case when trunc(sum(newu_day_premium), 2) > 0 then '+' || trunc(sum(newu_day_premium), 2) 
		       		when trunc(sum(newu_day_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_day_premium), 2)
		       		end newu_day_premium,
		       case when trunc(sum(newu_day_fee), 2) > 0 then '+' || trunc(sum(newu_day_fee), 2) 
		       		when trunc(sum(newu_day_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_day_fee), 2)
		       		end newu_day_fee,
		       
		       sum(u_month_count) u_month_count, sum(u_month_amount) u_month_amount,
		       sum(u_month_premium) u_month_premium, sum(u_month_fee) u_month_fee,
		       
		       case when trunc(sum(newu_month_premium), 2) > 0 then '+' || trunc(sum(newu_month_premium), 2) 
		       		when trunc(sum(newu_month_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_month_premium), 2)
		       		end newu_month_premium,
		       case when trunc(sum(newu_month_fee), 2) > 0 then '+' || trunc(sum(newu_month_fee), 2) 
		       		when trunc(sum(newu_month_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_month_fee), 2)
		       		end newu_month_fee,
		       
		       sum(u_year_count) u_year_count, sum(u_year_amount) u_year_amount,
		       sum(u_year_premium) u_year_premium, sum(u_year_fee) u_year_fee,
		       
		       case when trunc(sum(newu_year_premium), 2) > 0 then '+' || trunc(sum(newu_year_premium), 2) 
		       		when trunc(sum(newu_year_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_year_premium), 2)
		       		end newu_year_premium,
		       case when trunc(sum(newu_year_fee), 2) > 0 then '+' || trunc(sum(newu_year_fee), 2) 
		       		when trunc(sum(newu_year_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_year_fee), 2)
		       		end newu_year_fee
		  from (
		         select a.insurance_type_name,a.insurance_type_no,a.channel_no,
		                a.g_day_count,a.g_day_amount,a.g_day_premium,a.g_day_fee,
		                a.g_day_premium - nvl(k.g_day_premium, 0) newg_day_premium,
		                a.g_day_fee - nvl(k.g_day_fee, 0) newg_day_fee,
		                a.g_month_count,a.g_month_amount,a.g_month_premium,a.g_month_fee,
		                a.g_month_premium - nvl(k.g_month_premium, 0) newg_month_premium,
		                a.g_month_fee - nvl(k.g_month_fee, 0) newg_month_fee,
		                a.g_year_count,a.g_year_amount,a.g_year_premium,a.g_year_fee,
		                a.g_year_premium - nvl(k.g_year_premium, 0) newg_year_premium,
		                a.g_year_fee - nvl(k.g_year_fee, 0) newg_year_fee,
		                a.u_day_count,a.u_day_amount,a.u_day_premium,a.u_day_fee,
		                a.u_day_premium - nvl(k.u_day_premium, 0) newu_day_premium,
		                a.u_day_fee - nvl(k.u_day_fee, 0) newu_day_fee,
		                a.u_month_count,a.u_month_amount,a.u_month_premium,a.u_month_fee,
		                a.u_month_premium - nvl(k.u_month_premium, 0) newu_month_premium,
		                a.u_month_fee - nvl(k.u_month_fee, 0) newu_month_fee,
		                a.u_year_count,a.u_year_amount,a.u_year_premium,a.u_year_fee,
		                a.u_year_premium - nvl(k.u_year_premium, 0) newu_year_premium,
		                a.u_year_fee - nvl(k.u_year_fee, 0) newu_year_fee
		          from (select * from pro_bc_insurance_sum
		                  where 1=1
		                  	and date_flag = 'D'
		                  	<isNotEmpty prepend="and" property="term_date">
								term_date = #term_date#
					 		</isNotEmpty>
					 		<isEmpty prepend="and" property="term_date">
				          		term_date = sysdate
			          		</isEmpty>
		                    and channel_no in
		                        (select channelcode from sys_branch
		                          where channelcode is not null start with branch_id = #branch_id#
		                         connect by branch_parentid = prior branch_id
		                         <!-- <isEqual property="branch_id" compareValue="3702">
						        	union all
						        	select channelcode from sys_branch where branch_id='0111'
						         </isEqual> -->
		                         )
		               ) a
		          left join (select *
		                       from pro_bc_insurance_sum
		                      where 1=1
		                      	and date_flag = 'D'
		                      	<isNotEmpty prepend="and" property="term_date">
									term_date = add_months(#term_date#, -12)
						 		</isNotEmpty>
						 		<isEmpty prepend="and" property="term_date">
					          		term_date = add_months(sysdate, -12)
				          		</isEmpty>
				          		and channel_no in
		                        (select channelcode from sys_branch
		                          where channelcode is not null start with branch_id = #branch_id#
		                         connect by branch_parentid = prior branch_id
		                         <!-- <isEqual property="branch_id" compareValue="3702">
						        	union all
						        	select channelcode from sys_branch where branch_id='0111'
						         </isEqual> -->
		                         )
		                      ) k
		            on k.channel_no = a.channel_no
		           and k.insurance_type_no = a.insurance_type_no
		           where 1=1 and a.channel_no in (SELECT channelcode
                          FROM (SELECT DISTINCT branch_id       id,
                                                branch_name     name,
                                                branch_parentid pid,
                                                channelcode
                                  FROM sys_branch t
                                 WHERE t.status = '1'
                                 START WITH t.branch_id IN
                                            (SELECT tda.data_auth_no
                                               FROM t_data_auth tda
                                              WHERE tda.is_half_check IS NULL
                                                AND tda.object_no = #createUser#
                                                AND object_type = 'USER')
                                CONNECT BY PRIOR t.branch_id = branch_parentid))

		        )
 		group by insurance_type_no, insurance_type_name<!-- , channel_no -->
    </sql>
    
    <!--查询全险种报表所有信息-->
	<select id="queryinsurancecommission" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		<include refid="query_head"/>
		<include refid="query_allinsurance"/>
		<include refid="query_foot"/>
	</select>
	
	<!-- 查询全险种报表页数 -->
	<select id="insurancecommissioncount" parameterClass="sysbranchcommissionimpl" resultClass="int">
		select count(*) from (
		<include refid="query_allinsurance"/>
		)
	</select>
	
	<!--查询全险种汇总-->
	<select id="collectinsurance" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		<include refid="query_cityallhead"/>
		<include refid="query_allinsurance"/>
		<include refid="query_cityallfoot"/>
	</select>
	
	<!--查询全险种下载-->
	<select id="downloadinsurancecommission" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		<include refid="query_allinsurance"/>
	</select>
	
	
	
	
	
	<!--查询全险种下载-->
	<sql id="query_allinsurance_month">
			select insurance_type_no,insurance_type_name branch_name,channel_no,
		       sum(g_day_count) g_day_count,sum(g_day_amount) g_day_amount,
		       sum(g_day_premium) g_day_premium,sum(g_day_fee) g_day_fee,
		       
		       case when trunc(sum(newg_day_premium), 2) > 0 then '+' || trunc(sum(newg_day_premium), 2)
		       		when trunc(sum(newg_day_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_day_premium), 2)
		        	end newg_day_premium,
		       case when trunc(sum(newg_day_fee), 2) > 0 then '+' || trunc(sum(newg_day_fee), 2) 
		       		when trunc(sum(newg_day_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_day_fee), 2)
		       		end newg_day_fee,
		       
		       sum(g_month_count) g_month_count, sum(g_month_amount) g_month_amount,
		       sum(g_month_premium) g_month_premium, sum(g_month_fee) g_month_fee,
		       
		       case when trunc(sum(newg_month_premium), 2) > 0 then '+' || trunc(sum(newg_month_premium), 2) 
		       		when trunc(sum(newg_month_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_month_premium), 2)
		       		end newg_month_premium,
		       case when trunc(sum(newg_month_fee), 2) > 0 then '+' || trunc(sum(newg_month_fee), 2) 
		       		when trunc(sum(newg_month_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_month_fee), 2)
		       		end newg_month_fee,
		       
		       sum(g_year_count) g_year_count, sum(g_year_amount) g_year_amount,
		       sum(g_year_premium) g_year_premium, sum(g_year_fee) g_year_fee,
		       
		       case when trunc(sum(newg_year_premium), 2) > 0 then '+' || trunc(sum(newg_year_premium), 2) 
		       		when trunc(sum(newg_year_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_year_premium), 2)
		       		end newg_year_premium,
		       case when trunc(sum(newg_year_fee), 2) > 0 then '+' || trunc(sum(newg_year_fee), 2) 
		       		when trunc(sum(newg_year_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_year_fee), 2)
		       		end newg_year_fee,
		       
		       sum(u_day_count) u_day_count, sum(u_day_amount) u_day_amount,
		       sum(u_day_premium) u_day_premium, sum(u_day_fee) u_day_fee,
		       
		       case when trunc(sum(newu_day_premium), 2) > 0 then '+' || trunc(sum(newu_day_premium), 2) 
		       		when trunc(sum(newu_day_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_day_premium), 2)
		       		end newu_day_premium,
		       case when trunc(sum(newu_day_fee), 2) > 0 then '+' || trunc(sum(newu_day_fee), 2) 
		       		when trunc(sum(newu_day_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_day_fee), 2)
		       		end newu_day_fee,
		       
		       sum(u_month_count) u_month_count, sum(u_month_amount) u_month_amount,
		       sum(u_month_premium) u_month_premium, sum(u_month_fee) u_month_fee,
		       
		       case when trunc(sum(newu_month_premium), 2) > 0 then '+' || trunc(sum(newu_month_premium), 2) 
		       		when trunc(sum(newu_month_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_month_premium), 2)
		       		end newu_month_premium,
		       case when trunc(sum(newu_month_fee), 2) > 0 then '+' || trunc(sum(newu_month_fee), 2) 
		       		when trunc(sum(newu_month_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_month_fee), 2)
		       		end newu_month_fee,
		       
		       sum(u_year_count) u_year_count, sum(u_year_amount) u_year_amount,
		       sum(u_year_premium) u_year_premium, sum(u_year_fee) u_year_fee,
		       
		       case when trunc(sum(newu_year_premium), 2) > 0 then '+' || trunc(sum(newu_year_premium), 2) 
		       		when trunc(sum(newu_year_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_year_premium), 2)
		       		end newu_year_premium,
		       case when trunc(sum(newu_year_fee), 2) > 0 then '+' || trunc(sum(newu_year_fee), 2) 
		       		when trunc(sum(newu_year_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_year_fee), 2)
		       		end newu_year_fee
		  from (
		         select a.insurance_type_name,a.insurance_type_no,a.channel_no,
		                a.g_day_count,a.g_day_amount,a.g_day_premium,a.g_day_fee,
		                a.g_day_premium - nvl(k.g_day_premium, 0) newg_day_premium,
		                a.g_day_fee - nvl(k.g_day_fee, 0) newg_day_fee,
		                a.g_month_count,a.g_month_amount,a.g_month_premium,a.g_month_fee,
		                a.g_month_premium - nvl(k.g_month_premium, 0) newg_month_premium,
		                a.g_month_fee - nvl(k.g_month_fee, 0) newg_month_fee,
		                a.g_year_count,a.g_year_amount,a.g_year_premium,a.g_year_fee,
		                a.g_year_premium - nvl(k.g_year_premium, 0) newg_year_premium,
		                a.g_year_fee - nvl(k.g_year_fee, 0) newg_year_fee,
		                a.u_day_count,a.u_day_amount,a.u_day_premium,a.u_day_fee,
		                a.u_day_premium - nvl(k.u_day_premium, 0) newu_day_premium,
		                a.u_day_fee - nvl(k.u_day_fee, 0) newu_day_fee,
		                a.u_month_count,a.u_month_amount,a.u_month_premium,a.u_month_fee,
		                a.u_month_premium - nvl(k.u_month_premium, 0) newu_month_premium,
		                a.u_month_fee - nvl(k.u_month_fee, 0) newu_month_fee,
		                a.u_year_count,a.u_year_amount,a.u_year_premium,a.u_year_fee,
		                a.u_year_premium - nvl(k.u_year_premium, 0) newu_year_premium,
		                a.u_year_fee - nvl(k.u_year_fee, 0) newu_year_fee
		          from (select * from pro_bc_insurance_sum
		                  where 1=1
		                  and date_flag = 'M'
		                  	<isNotEmpty prepend="and" property="term_date">
								term_date = trunc(add_months(TO_DATE(#term_date#, 'yyyy-mm-dd'), +1) ,'mm') 
					 		</isNotEmpty>
					 		<isEmpty prepend="and" property="term_date">
				          		term_date = trunc(add_months(TO_DATE(sysdate, 'yyyy-mm-dd'), +1) ,'mm')  
			          		</isEmpty>
		                    and channel_no in
		                        (select channelcode from sys_branch
		                          where channelcode is not null start with branch_id = #branch_id#
		                         connect by branch_parentid = prior branch_id
		                         <isEqual property="branch_id" compareValue="3702">
						        	union all
						        	select channelcode from sys_branch where branch_id='0111'
						         </isEqual>
		                         )
		               ) a
		          left join (select g_day_premium,g_day_fee,
		                            g_month_premium,g_month_fee,
		                            g_year_premium,g_year_fee,
		                            u_day_premium,u_day_fee,
		                            u_month_premium,u_month_fee,
		                            u_year_premium,u_year_fee,
		                            channel_no,insurance_type_no
		                       from pro_bc_insurance_sum
		                      where 1=1
		                      and date_flag = 'M'
		                      	<isNotEmpty prepend="and" property="term_date">
									term_date = trunc(add_months(TO_DATE(#term_date#, 'yyyy-mm-dd'), -11) ,'mm')
						 		</isNotEmpty>
						 		<isEmpty prepend="and" property="term_date">
					          		term_date = trunc(add_months(TO_DATE(sysdate, 'yyyy-mm-dd'), -11) ,'mm') 
				          		</isEmpty>
		                      ) k
		            on k.channel_no = a.channel_no
		           and k.insurance_type_no = a.insurance_type_no
		        )
 		group by insurance_type_no, insurance_type_name, channel_no
    </sql>
    
    <!--查询全险种报表所有信息-->
	<select id="queryinsurance_monthcommission" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		<include refid="query_head"/>
		<include refid="query_allinsurance_month"/>
		<include refid="query_foot"/>
	</select>
	
	<!-- 查询全险种报表页数 -->
	<select id="insurancec_monthommissioncount" parameterClass="sysbranchcommissionimpl" resultClass="int">
		select count(*) from (
		<include refid="query_allinsurance_month"/>
		)
	</select>
	
	<!--查询全险种汇总-->
	<select id="collectinsurance_month" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		<include refid="query_cityallhead"/>
		<include refid="query_allinsurance_month"/>
		<include refid="query_cityallfoot"/>
	</select>
	
	<!--查询全险种下载-->
	<select id="downloadinsurance_monthcommission" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		<include refid="query_allinsurance_month"/>
	</select>
	
	
	
	
	
	

	<!-- 保险公司查询主干 -->
	<sql id="query_allcpybranch">

		<!--展示一级的保险公司  -->
		select branch_name,
       branch_id org_id,
       nvl(sum(g_day_count),0) g_day_count,
       nvl(sum(g_day_amount),0) g_day_amount,
       nvl(sum(g_day_premium),0) g_day_premium,
       nvl(sum(g_day_fee),0) g_day_fee,
       case
         when trunc(sum(newg_day_premium), 2) > 0 then
          '+' || trunc(sum(newg_day_premium), 2)
         when trunc(sum(newg_day_premium), 2) = 0 then
          '0'
         else
          '' || nvl(trunc(sum(newg_day_premium), 2),0)
       end newg_day_premium,
       case
         when trunc(sum(newg_day_fee), 2) > 0 then
          '+' || trunc(sum(newg_day_fee), 2)
         when trunc(sum(newg_day_fee), 2) = 0 then
          '0'
         else
          '' || nvl(trunc(sum(newg_day_fee), 2),0)
       end newg_day_fee,
       nvl(sum(g_month_count),0) g_month_count,
       nvl(sum(g_month_amount),0) g_month_amount,
       nvl(sum(g_month_premium),0) g_month_premium,
       nvl(sum(g_month_fee),0) g_month_fee,
       case
         when trunc(sum(newg_month_premium), 2) > 0 then
          '+' || trunc(sum(newg_month_premium), 2)
         when trunc(sum(newg_month_premium), 2) = 0 then
          '0'
         else
          '' || nvl(trunc(sum(newg_month_premium), 2),0)
       end newg_month_premium,
       case
         when trunc(sum(newg_month_fee), 2) > 0 then
          '+' || trunc(sum(newg_month_fee), 2)
         when trunc(sum(newg_month_fee), 2) = 0 then
          '0'
         else
          '' || nvl(trunc(sum(newg_month_fee), 2),0)
       end newg_month_fee,
       nvl(sum(g_year_count),0) g_year_count,
       nvl(sum(g_year_amount),0) g_year_amount,
       nvl(sum(g_year_premium),0) g_year_premium,
       nvl(sum(g_year_fee),0) g_year_fee,
       case
         when trunc(sum(newg_year_premium), 2) > 0 then
          '+' || trunc(sum(newg_year_premium), 2)
         when trunc(sum(newg_year_premium), 2) = 0 then
          '0'
         else
          '' || nvl(trunc(sum(newg_year_premium), 2),0) 
       end newg_year_premium,
       case
         when trunc(sum(newg_year_fee), 2) > 0 then
          '+' || trunc(sum(newg_year_fee), 2)
         when trunc(sum(newg_year_fee), 2) = 0 then
          '0'
         else
          '' || nvl(trunc(sum(newg_year_fee), 2),0) 
       end newg_year_fee,
       nvl(sum(u_day_count),0) u_day_count,
       nvl(sum(u_day_amount),0) u_day_amount,
       nvl(sum(u_day_premium),0) u_day_premium,
       nvl(sum(u_day_fee),0) u_day_fee,
       case
         when trunc(sum(newu_day_premium), 2) > 0 then
          '+' || trunc(sum(newu_day_premium), 2)
         when trunc(sum(newu_day_premium), 2) = 0 then
          '0'
         else
          '' || nvl(trunc(sum(newu_day_premium), 2),0) 
       end newu_day_premium,
       case
         when trunc(sum(newu_day_fee), 2) > 0 then
          '+' || trunc(sum(newu_day_fee), 2)
         when trunc(sum(newu_day_fee), 2) = 0 then
          '0'
         else
          '' || nvl(trunc(sum(newu_day_fee), 2),0) 
       end newu_day_fee,
       nvl(sum(u_month_count),0) u_month_count,
       nvl(sum(u_month_amount),0) u_month_amount,
       nvl(sum(u_month_premium),0) u_month_premium,
       nvl(sum(u_month_fee),0) u_month_fee,
       case
         when trunc(sum(newu_month_premium), 2) > 0 then
          '+' || trunc(sum(newu_month_premium), 2)
         when trunc(sum(newu_month_premium), 2) = 0 then
          '0'
         else
          '' || nvl(trunc(sum(newu_month_premium), 2),0)
       end newu_month_premium,
       case
         when trunc(sum(newu_month_fee), 2) > 0 then
          '+' || trunc(sum(newu_month_fee), 2)
         when trunc(sum(newu_month_fee), 2) = 0 then
          '0'
         else
          '' || nvl(trunc(sum(newu_month_fee), 2),0)
       end newu_month_fee,
       nvl(sum(u_year_count),0) u_year_count,
       nvl(sum(u_year_amount),0) u_year_amount,
       nvl(sum(u_year_premium),0) u_year_premium,
       nvl(sum(u_year_fee),0) u_year_fee,
       case
         when trunc(sum(newu_year_premium), 2) > 0 then
          '+' || trunc(sum(newu_year_premium), 2)
         when trunc(sum(newu_year_premium), 2) = 0 then
          '0'
         else
          '' || nvl(trunc(sum(newu_year_premium), 2),0)
       end newu_year_premium,
       case
         when trunc(sum(newu_year_fee), 2) > 0 then
          '+' || trunc(sum(newu_year_fee), 2)
         when trunc(sum(newu_year_fee), 2) = 0 then
          '0'
         else
          '' || nvl(trunc(sum(newu_year_fee), 2),0)
       end newu_year_fee
  from (select a.g_day_count,
               a.g_day_amount,
               a.g_day_premium,
               a.g_day_fee,
               a.g_day_premium - nvl(k.g_day_premium, 0) newg_day_premium,
               a.g_day_fee - nvl(k.g_day_fee, 0) newg_day_fee,
               a.g_month_count,
               a.g_month_amount,
               a.g_month_premium,
               a.g_month_fee,
               a.g_month_premium - nvl(k.g_month_premium, 0) newg_month_premium,
               a.g_month_fee - nvl(k.g_month_fee, 0) newg_month_fee,
               a.g_year_count,
               a.g_year_amount,
               a.g_year_premium,
               a.g_year_fee,
               a.g_year_premium - nvl(k.g_year_premium, 0) newg_year_premium,
               a.g_year_fee - nvl(k.g_year_fee, 0) newg_year_fee,
               a.u_day_count,
               a.u_day_amount,
               a.u_day_premium,
               a.u_day_fee,
               a.u_day_premium - nvl(k.u_day_premium, 0) newu_day_premium,
               a.u_day_fee - nvl(k.u_day_fee, 0) newu_day_fee,
               a.u_month_count,
               a.u_month_amount,
               a.u_month_premium,
               a.u_month_fee,
               a.u_month_premium - nvl(k.u_month_premium, 0) newu_month_premium,
               a.u_month_fee - nvl(k.u_month_fee, 0) newu_month_fee,
               a.u_year_count,
               a.u_year_amount,
               a.u_year_premium,
               a.u_year_fee,
               a.u_year_premium - nvl(k.u_year_premium, 0) newu_year_premium,
               a.u_year_fee - nvl(k.u_year_fee, 0) newu_year_fee
          from (select sum(sum_1.G_DAY_COUNT) G_DAY_COUNT,
                       sum(sum_1.G_DAY_AMOUNT) G_DAY_AMOUNT,
                       sum(sum_1.G_DAY_PREMIUM) G_DAY_PREMIUM,
                       sum(sum_1.G_DAY_FEE) G_DAY_FEE,
                       sum(sum_1.G_MONTH_COUNT) G_MONTH_COUNT,
                       sum(sum_1.G_MONTH_AMOUNT) G_MONTH_AMOUNT,
                       sum(sum_1.G_MONTH_PREMIUM) G_MONTH_PREMIUM,
                       sum(sum_1.G_MONTH_FEE) G_MONTH_FEE,
                       sum(sum_1.G_YEAR_COUNT) G_YEAR_COUNT,
                       sum(sum_1.G_YEAR_AMOUNT) G_YEAR_AMOUNT,
                       sum(sum_1.G_YEAR_PREMIUM) G_YEAR_PREMIUM,
                       sum(sum_1.G_YEAR_FEE) G_YEAR_FEE,
                       sum(sum_1.U_DAY_COUNT) U_DAY_COUNT,
                       sum(sum_1.U_DAY_AMOUNT) U_DAY_AMOUNT,
                       sum(sum_1.U_DAY_PREMIUM) U_DAY_PREMIUM,
                       sum(sum_1.U_DAY_FEE) U_DAY_FEE,
                       sum(sum_1.U_MONTH_COUNT) U_MONTH_COUNT,
                       sum(sum_1.U_MONTH_AMOUNT) U_MONTH_AMOUNT,
                       sum(sum_1.U_MONTH_PREMIUM) U_MONTH_PREMIUM,
                       sum(sum_1.U_MONTH_FEE) U_MONTH_FEE,
                       sum(sum_1.U_YEAR_COUNT) U_YEAR_COUNT,
                       sum(sum_1.U_YEAR_AMOUNT) U_YEAR_AMOUNT,
                       sum(sum_1.U_YEAR_PREMIUM) U_YEAR_PREMIUM,
                       sum(sum_1.U_YEAR_FEE) U_YEAR_FEE
                  from pro_bc_org_sum sum_1
                  where sum_1.date_flag = 'D'
                   and sum_1.term_date = #term_date#
                   and sum_1.channel_no in
                       (SELECT channelcode
                          FROM (SELECT DISTINCT branch_id       id,
                                                branch_name     name,
                                                branch_parentid pid,
                                                channelcode
                                  FROM sys_branch t
                                 WHERE t.status = '1'
                                 START WITH t.branch_id IN
                                            (SELECT tda.data_auth_no
                                               FROM t_data_auth tda
                                              WHERE tda.is_half_check IS NULL
                                                AND tda.object_no =  #createUser#
                                                AND object_type = 'USER')
                                CONNECT BY PRIOR t.branch_id = branch_parentid))
                   and sum_1.channel_no in
                       (select ind_branch.channelcode
                          from sys_branch ind_branch
                         where ind_branch.status = '1'
                         Start With ind_branch.branch_id =  #branch_id#
                        Connect By Prior ind_branch.branch_id =
                                    ind_branch.branch_parentid)
                  and sum_1.org_id in (select cpy_branch_com.branch_id
                             from cpy_branch cpy_branch_com
                             where cpy_branch_com.status = '1'
                            Start With cpy_branch_com.branch_id = #cpy_branch_id#
                           Connect By NOCYCLE Prior cpy_branch_com.branch_id =
                                       cpy_branch_com.branch_parentid)) a,
                  (select sum(sum_1.G_DAY_COUNT) G_DAY_COUNT,
                           sum(sum_1.G_DAY_AMOUNT) G_DAY_AMOUNT,
                           sum(sum_1.G_DAY_PREMIUM) G_DAY_PREMIUM,
                           sum(sum_1.G_DAY_FEE) G_DAY_FEE,
                           sum(sum_1.G_MONTH_COUNT) G_MONTH_COUNT,
                           sum(sum_1.G_MONTH_AMOUNT) G_MONTH_AMOUNT,
                           sum(sum_1.G_MONTH_PREMIUM) G_MONTH_PREMIUM,
                           sum(sum_1.G_MONTH_FEE) G_MONTH_FEE,
                           sum(sum_1.G_YEAR_COUNT) G_YEAR_COUNT,
                           sum(sum_1.G_YEAR_AMOUNT) G_YEAR_AMOUNT,
                           sum(sum_1.G_YEAR_PREMIUM) G_YEAR_PREMIUM,
                           sum(sum_1.G_YEAR_FEE) G_YEAR_FEE,
                           sum(sum_1.U_DAY_COUNT) U_DAY_COUNT,
                           sum(sum_1.U_DAY_AMOUNT) U_DAY_AMOUNT,
                           sum(sum_1.U_DAY_PREMIUM) U_DAY_PREMIUM,
                           sum(sum_1.U_DAY_FEE) U_DAY_FEE,
                           sum(sum_1.U_MONTH_COUNT) U_MONTH_COUNT,
                           sum(sum_1.U_MONTH_AMOUNT) U_MONTH_AMOUNT,
                           sum(sum_1.U_MONTH_PREMIUM) U_MONTH_PREMIUM,
                           sum(sum_1.U_MONTH_FEE) U_MONTH_FEE,
                           sum(sum_1.U_YEAR_COUNT) U_YEAR_COUNT,
                           sum(sum_1.U_YEAR_AMOUNT) U_YEAR_AMOUNT,
                           sum(sum_1.U_YEAR_PREMIUM) U_YEAR_PREMIUM,
                           sum(sum_1.U_YEAR_FEE) U_YEAR_FEE
                      from pro_bc_org_sum sum_1
                      where sum_1.date_flag = 'D'
                       and sum_1.term_date = add_months( #term_date#, -12)
                       and sum_1.channel_no in
                           (SELECT channelcode
                              FROM (SELECT DISTINCT branch_id       id,
                                                    branch_name     name,
                                                    branch_parentid pid,
                                                    channelcode
                                      FROM sys_branch t
                                     WHERE t.status = '1'
                                     START WITH t.branch_id IN
                                                (SELECT tda.data_auth_no
                                                   FROM t_data_auth tda
                                                  WHERE tda.is_half_check IS NULL
                                                    AND tda.object_no =  #createUser#
                                                    AND object_type = 'USER')
                                    CONNECT BY PRIOR
                                                t.branch_id = branch_parentid))
                       and sum_1.channel_no in
                           (select ind_branch.channelcode
                              from sys_branch ind_branch
                             where ind_branch.status = '1'
                             Start With ind_branch.branch_id =  #branch_id#
                            Connect By Prior ind_branch.branch_id =
                                        ind_branch.branch_parentid)
                       and sum_1.org_id in (select cpy_branch_com.branch_id
                             from cpy_branch cpy_branch_com
                             where cpy_branch_com.status = '1'
                            Start With cpy_branch_com.branch_id = #cpy_branch_id#
                           Connect By NOCYCLE Prior cpy_branch_com.branch_id =
                                       cpy_branch_com.branch_parentid)) k),(select branch_id,branch_name from cpy_branch where status = '1' and branch_id =  #cpy_branch_id#)
                       group by branch_id,branch_name
			<!-- select org_name branch_name,org_id,
		       sum(g_day_count) g_day_count,sum(g_day_amount) g_day_amount,
		       sum(g_day_premium) g_day_premium,sum(g_day_fee) g_day_fee,
		       
		       case when trunc(sum(newg_day_premium), 2) > 0 then '+' || trunc(sum(newg_day_premium), 2)
		       		when trunc(sum(newg_day_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_day_premium), 2)
		        	end newg_day_premium,
		       case when trunc(sum(newg_day_fee), 2) > 0 then '+' || trunc(sum(newg_day_fee), 2) 
		       		when trunc(sum(newg_day_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_day_fee), 2)
		       		end newg_day_fee,
		       
		       sum(g_month_count) g_month_count, sum(g_month_amount) g_month_amount,
		       sum(g_month_premium) g_month_premium, sum(g_month_fee) g_month_fee,
		       
		       case when trunc(sum(newg_month_premium), 2) > 0 then '+' || trunc(sum(newg_month_premium), 2) 
		       		when trunc(sum(newg_month_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_month_premium), 2)
		       		end newg_month_premium,
		       case when trunc(sum(newg_month_fee), 2) > 0 then '+' || trunc(sum(newg_month_fee), 2) 
		       		when trunc(sum(newg_month_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_month_fee), 2)
		       		end newg_month_fee,
		       
		       sum(g_year_count) g_year_count, sum(g_year_amount) g_year_amount,
		       sum(g_year_premium) g_year_premium, sum(g_year_fee) g_year_fee,
		       
		       case when trunc(sum(newg_year_premium), 2) > 0 then '+' || trunc(sum(newg_year_premium), 2) 
		       		when trunc(sum(newg_year_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_year_premium), 2)
		       		end newg_year_premium,
		       case when trunc(sum(newg_year_fee), 2) > 0 then '+' || trunc(sum(newg_year_fee), 2) 
		       		when trunc(sum(newg_year_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_year_fee), 2)
		       		end newg_year_fee,
		       
		       sum(u_day_count) u_day_count, sum(u_day_amount) u_day_amount,
		       sum(u_day_premium) u_day_premium, sum(u_day_fee) u_day_fee,
		       
		       case when trunc(sum(newu_day_premium), 2) > 0 then '+' || trunc(sum(newu_day_premium), 2) 
		       		when trunc(sum(newu_day_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_day_premium), 2)
		       		end newu_day_premium,
		       case when trunc(sum(newu_day_fee), 2) > 0 then '+' || trunc(sum(newu_day_fee), 2) 
		       		when trunc(sum(newu_day_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_day_fee), 2)
		       		end newu_day_fee,
		       
		       sum(u_month_count) u_month_count, sum(u_month_amount) u_month_amount,
		       sum(u_month_premium) u_month_premium, sum(u_month_fee) u_month_fee,
		       
		       case when trunc(sum(newu_month_premium), 2) > 0 then '+' || trunc(sum(newu_month_premium), 2) 
		       		when trunc(sum(newu_month_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_month_premium), 2)
		       		end newu_month_premium,
		       case when trunc(sum(newu_month_fee), 2) > 0 then '+' || trunc(sum(newu_month_fee), 2) 
		       		when trunc(sum(newu_month_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_month_fee), 2)
		       		end newu_month_fee,
		       
		       sum(u_year_count) u_year_count, sum(u_year_amount) u_year_amount,
		       sum(u_year_premium) u_year_premium, sum(u_year_fee) u_year_fee,
		       
		       case when trunc(sum(newu_year_premium), 2) > 0 then '+' || trunc(sum(newu_year_premium), 2) 
		       		when trunc(sum(newu_year_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_year_premium), 2)
		       		end newu_year_premium,
		       case when trunc(sum(newu_year_fee), 2) > 0 then '+' || trunc(sum(newu_year_fee), 2) 
		       		when trunc(sum(newu_year_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_year_fee), 2)
		       		end newu_year_fee
		  from (
		         select a.org_name,a.org_id,
		                a.g_day_count,a.g_day_amount,a.g_day_premium,a.g_day_fee,
		                a.g_day_premium - nvl(k.g_day_premium, 0) newg_day_premium,
		                a.g_day_fee - nvl(k.g_day_fee, 0) newg_day_fee,
		                a.g_month_count,a.g_month_amount,a.g_month_premium,a.g_month_fee,
		                a.g_month_premium - nvl(k.g_month_premium, 0) newg_month_premium,
		                a.g_month_fee - nvl(k.g_month_fee, 0) newg_month_fee,
		                a.g_year_count,a.g_year_amount,a.g_year_premium,a.g_year_fee,
		                a.g_year_premium - nvl(k.g_year_premium, 0) newg_year_premium,
		                a.g_year_fee - nvl(k.g_year_fee, 0) newg_year_fee,
		                a.u_day_count,a.u_day_amount,a.u_day_premium,a.u_day_fee,
		                a.u_day_premium - nvl(k.u_day_premium, 0) newu_day_premium,
		                a.u_day_fee - nvl(k.u_day_fee, 0) newu_day_fee,
		                a.u_month_count,a.u_month_amount,a.u_month_premium,a.u_month_fee,
		                a.u_month_premium - nvl(k.u_month_premium, 0) newu_month_premium,
		                a.u_month_fee - nvl(k.u_month_fee, 0) newu_month_fee,
		                a.u_year_count,a.u_year_amount,a.u_year_premium,a.u_year_fee,
		                a.u_year_premium - nvl(k.u_year_premium, 0) newu_year_premium,
		                a.u_year_fee - nvl(k.u_year_fee, 0) newu_year_fee
		          from (
		          
		          select * from pro_bc_org_sum
		                  where 1=1
		                  	<isNotEmpty prepend="and" property="term_date">
								term_date = #term_date#
					 		</isNotEmpty>
					 		<isEmpty prepend="and" property="term_date">
				          		term_date = sysdate
			          		</isEmpty>
		                    and channel_no in
		                        (select channelcode from sys_branch
		                          where channelcode is not null start with branch_id = #branch_id#
		                         connect by branch_parentid = prior branch_id
		                         <isEqual property="branch_id" compareValue="3702">
						        	union all
						        	select channelcode from sys_branch where branch_id='0111'
						         </isEqual>
		                         )
		                     and org_id in (select branch_id from cpy_branch cb where cb.branch_parentid = #cpybranch_id#)
		                     
		                     select 
								(select sum(sum_1.G_DAY_COUNT         ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_DAY_COUNT         ,
								(select sum(sum_1.G_DAY_AMOUNT        ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_DAY_AMOUNT        ,
								(select sum(sum_1.G_DAY_PREMIUM       ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_DAY_PREMIUM       ,
								(select sum(sum_1.G_DAY_FEE           ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_DAY_FEE           ,
								(select sum(sum_1.G_MONTH_COUNT       ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_MONTH_COUNT       ,
								(select sum(sum_1.G_MONTH_AMOUNT      ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_MONTH_AMOUNT      ,
								(select sum(sum_1.G_MONTH_PREMIUM     ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_MONTH_PREMIUM     ,
								(select sum(sum_1.G_MONTH_FEE         ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_MONTH_FEE         ,
								(select sum(sum_1.G_YEAR_COUNT        ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_YEAR_COUNT        ,
								(select sum(sum_1.G_YEAR_AMOUNT       ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_YEAR_AMOUNT       ,
								(select sum(sum_1.G_YEAR_PREMIUM      ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_YEAR_PREMIUM      ,
								(select sum(sum_1.G_YEAR_FEE          ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_YEAR_FEE          ,
								(select sum(sum_1.U_DAY_COUNT         ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_DAY_COUNT         ,
								(select sum(sum_1.U_DAY_AMOUNT        ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_DAY_AMOUNT        ,
								(select sum(sum_1.U_DAY_PREMIUM       ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_DAY_PREMIUM       ,
								(select sum(sum_1.U_DAY_FEE           ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_DAY_FEE           ,
								(select sum(sum_1.U_MONTH_COUNT       ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_MONTH_COUNT       ,
								(select sum(sum_1.U_MONTH_AMOUNT      ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_MONTH_AMOUNT      ,
								(select sum(sum_1.U_MONTH_PREMIUM     ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_MONTH_PREMIUM     ,
								(select sum(sum_1.U_MONTH_FEE         ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_MONTH_FEE         ,
								(select sum(sum_1.U_YEAR_COUNT        ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_YEAR_COUNT        ,
								(select sum(sum_1.U_YEAR_AMOUNT       ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_YEAR_AMOUNT       ,
								(select sum(sum_1.U_YEAR_PREMIUM      ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_YEAR_PREMIUM      ,
								(select sum(sum_1.U_YEAR_FEE          ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_YEAR_FEE          ,
								 b.branch_name org_name,
								 b.branch_id org_id
							from cpy_branch b where b.branch_level = '1'
		                     
		               ) a
		          left join (
		          
		          select 
					(select sum(sum_1.G_DAY_COUNT         ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_DAY_COUNT         ,
					(select sum(sum_1.G_DAY_AMOUNT        ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_DAY_AMOUNT        ,
					(select sum(sum_1.G_DAY_PREMIUM       ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_DAY_PREMIUM       ,
					(select sum(sum_1.G_DAY_FEE           ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_DAY_FEE           ,
					(select sum(sum_1.G_MONTH_COUNT       ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_MONTH_COUNT       ,
					(select sum(sum_1.G_MONTH_AMOUNT      ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_MONTH_AMOUNT      ,
					(select sum(sum_1.G_MONTH_PREMIUM     ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_MONTH_PREMIUM     ,
					(select sum(sum_1.G_MONTH_FEE         ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_MONTH_FEE         ,
					(select sum(sum_1.G_YEAR_COUNT        ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_YEAR_COUNT        ,
					(select sum(sum_1.G_YEAR_AMOUNT       ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_YEAR_AMOUNT       ,
					(select sum(sum_1.G_YEAR_PREMIUM      ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_YEAR_PREMIUM      ,
					(select sum(sum_1.G_YEAR_FEE          ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_YEAR_FEE          ,
					(select sum(sum_1.U_DAY_COUNT         ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_DAY_COUNT         ,
					(select sum(sum_1.U_DAY_AMOUNT        ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_DAY_AMOUNT        ,
					(select sum(sum_1.U_DAY_PREMIUM       ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_DAY_PREMIUM       ,
					(select sum(sum_1.U_DAY_FEE           ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_DAY_FEE           ,
					(select sum(sum_1.U_MONTH_COUNT       ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_MONTH_COUNT       ,
					(select sum(sum_1.U_MONTH_AMOUNT      ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_MONTH_AMOUNT      ,
					(select sum(sum_1.U_MONTH_PREMIUM     ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_MONTH_PREMIUM     ,
					(select sum(sum_1.U_MONTH_FEE         ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_MONTH_FEE         ,
					(select sum(sum_1.U_YEAR_COUNT        ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_YEAR_COUNT        ,
					(select sum(sum_1.U_YEAR_AMOUNT       ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_YEAR_AMOUNT       ,
					(select sum(sum_1.U_YEAR_PREMIUM      ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_YEAR_PREMIUM      ,
					(select sum(sum_1.U_YEAR_FEE          ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'D' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_YEAR_FEE          ,
					 b.branch_name org_name,
					 b.branch_id org_id
				from cpy_branch b where b.branch_level = '1'
		                       
		                      ) k
		            on  k.org_id=a.org_id
		        )
		        <isNotEmpty property="cpy_branch_id">
					where org_id = #cpy_branch_id#
				</isNotEmpty>
 		group by org_name,org_id -->
    </sql>
    
    
    <!-- 保险公司查询主干 -->
	<sql id="query_allcpybranch_month">
			select org_name branch_name,org_id,
		       sum(g_day_count) g_day_count,sum(g_day_amount) g_day_amount,
		       sum(g_day_premium) g_day_premium,sum(g_day_fee) g_day_fee,
		       
		       case when trunc(sum(newg_day_premium), 2) > 0 then '+' || trunc(sum(newg_day_premium), 2)
		       		when trunc(sum(newg_day_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_day_premium), 2)
		        	end newg_day_premium,
		       case when trunc(sum(newg_day_fee), 2) > 0 then '+' || trunc(sum(newg_day_fee), 2) 
		       		when trunc(sum(newg_day_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_day_fee), 2)
		       		end newg_day_fee,
		       
		       sum(g_month_count) g_month_count, sum(g_month_amount) g_month_amount,
		       sum(g_month_premium) g_month_premium, sum(g_month_fee) g_month_fee,
		       
		       case when trunc(sum(newg_month_premium), 2) > 0 then '+' || trunc(sum(newg_month_premium), 2) 
		       		when trunc(sum(newg_month_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_month_premium), 2)
		       		end newg_month_premium,
		       case when trunc(sum(newg_month_fee), 2) > 0 then '+' || trunc(sum(newg_month_fee), 2) 
		       		when trunc(sum(newg_month_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_month_fee), 2)
		       		end newg_month_fee,
		       
		       sum(g_year_count) g_year_count, sum(g_year_amount) g_year_amount,
		       sum(g_year_premium) g_year_premium, sum(g_year_fee) g_year_fee,
		       
		       case when trunc(sum(newg_year_premium), 2) > 0 then '+' || trunc(sum(newg_year_premium), 2) 
		       		when trunc(sum(newg_year_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_year_premium), 2)
		       		end newg_year_premium,
		       case when trunc(sum(newg_year_fee), 2) > 0 then '+' || trunc(sum(newg_year_fee), 2) 
		       		when trunc(sum(newg_year_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_year_fee), 2)
		       		end newg_year_fee,
		       
		       sum(u_day_count) u_day_count, sum(u_day_amount) u_day_amount,
		       sum(u_day_premium) u_day_premium, sum(u_day_fee) u_day_fee,
		       
		       case when trunc(sum(newu_day_premium), 2) > 0 then '+' || trunc(sum(newu_day_premium), 2) 
		       		when trunc(sum(newu_day_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_day_premium), 2)
		       		end newu_day_premium,
		       case when trunc(sum(newu_day_fee), 2) > 0 then '+' || trunc(sum(newu_day_fee), 2) 
		       		when trunc(sum(newu_day_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_day_fee), 2)
		       		end newu_day_fee,
		       
		       sum(u_month_count) u_month_count, sum(u_month_amount) u_month_amount,
		       sum(u_month_premium) u_month_premium, sum(u_month_fee) u_month_fee,
		       
		       case when trunc(sum(newu_month_premium), 2) > 0 then '+' || trunc(sum(newu_month_premium), 2) 
		       		when trunc(sum(newu_month_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_month_premium), 2)
		       		end newu_month_premium,
		       case when trunc(sum(newu_month_fee), 2) > 0 then '+' || trunc(sum(newu_month_fee), 2) 
		       		when trunc(sum(newu_month_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_month_fee), 2)
		       		end newu_month_fee,
		       
		       sum(u_year_count) u_year_count, sum(u_year_amount) u_year_amount,
		       sum(u_year_premium) u_year_premium, sum(u_year_fee) u_year_fee,
		       
		       case when trunc(sum(newu_year_premium), 2) > 0 then '+' || trunc(sum(newu_year_premium), 2) 
		       		when trunc(sum(newu_year_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_year_premium), 2)
		       		end newu_year_premium,
		       case when trunc(sum(newu_year_fee), 2) > 0 then '+' || trunc(sum(newu_year_fee), 2) 
		       		when trunc(sum(newu_year_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_year_fee), 2)
		       		end newu_year_fee
		  from (
		         select a.org_name,a.org_id,
		                a.g_day_count,a.g_day_amount,a.g_day_premium,a.g_day_fee,
		                a.g_day_premium - nvl(k.g_day_premium, 0) newg_day_premium,
		                a.g_day_fee - nvl(k.g_day_fee, 0) newg_day_fee,
		                a.g_month_count,a.g_month_amount,a.g_month_premium,a.g_month_fee,
		                a.g_month_premium - nvl(k.g_month_premium, 0) newg_month_premium,
		                a.g_month_fee - nvl(k.g_month_fee, 0) newg_month_fee,
		                a.g_year_count,a.g_year_amount,a.g_year_premium,a.g_year_fee,
		                a.g_year_premium - nvl(k.g_year_premium, 0) newg_year_premium,
		                a.g_year_fee - nvl(k.g_year_fee, 0) newg_year_fee,
		                a.u_day_count,a.u_day_amount,a.u_day_premium,a.u_day_fee,
		                a.u_day_premium - nvl(k.u_day_premium, 0) newu_day_premium,
		                a.u_day_fee - nvl(k.u_day_fee, 0) newu_day_fee,
		                a.u_month_count,a.u_month_amount,a.u_month_premium,a.u_month_fee,
		                a.u_month_premium - nvl(k.u_month_premium, 0) newu_month_premium,
		                a.u_month_fee - nvl(k.u_month_fee, 0) newu_month_fee,
		                a.u_year_count,a.u_year_amount,a.u_year_premium,a.u_year_fee,
		                a.u_year_premium - nvl(k.u_year_premium, 0) newu_year_premium,
		                a.u_year_fee - nvl(k.u_year_fee, 0) newu_year_fee
		          from (
		          
<!-- 		          select * from pro_bc_org_sum
		                  where 1=1
		                  	<isNotEmpty prepend="and" property="term_date">
								term_date = #term_date#
					 		</isNotEmpty>
					 		<isEmpty prepend="and" property="term_date">
				          		term_date = sysdate
			          		</isEmpty>
		                    and channel_no in
		                        (select channelcode from sys_branch
		                          where channelcode is not null start with branch_id = #branch_id#
		                         connect by branch_parentid = prior branch_id
		                         <isEqual property="branch_id" compareValue="3702">
						        	union all
						        	select channelcode from sys_branch where branch_id='0111'
						         </isEqual>
		                         )
		                     and org_id in (select branch_id from cpy_branch cb where cb.branch_parentid = #cpybranch_id#) -->
		                     
		                     select 
								(select sum(sum_1.G_DAY_COUNT         ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_DAY_COUNT         ,
								(select sum(sum_1.G_DAY_AMOUNT        ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_DAY_AMOUNT        ,
								(select sum(sum_1.G_DAY_PREMIUM       ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_DAY_PREMIUM       ,
								(select sum(sum_1.G_DAY_FEE           ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_DAY_FEE           ,
								(select sum(sum_1.G_MONTH_COUNT       ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_MONTH_COUNT       ,
								(select sum(sum_1.G_MONTH_AMOUNT      ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_MONTH_AMOUNT      ,
								(select sum(sum_1.G_MONTH_PREMIUM     ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_MONTH_PREMIUM     ,
								(select sum(sum_1.G_MONTH_FEE         ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_MONTH_FEE         ,
								(select sum(sum_1.G_YEAR_COUNT        ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_YEAR_COUNT        ,
								(select sum(sum_1.G_YEAR_AMOUNT       ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_YEAR_AMOUNT       ,
								(select sum(sum_1.G_YEAR_PREMIUM      ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_YEAR_PREMIUM      ,
								(select sum(sum_1.G_YEAR_FEE          ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_YEAR_FEE          ,
								(select sum(sum_1.U_DAY_COUNT         ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_DAY_COUNT         ,
								(select sum(sum_1.U_DAY_AMOUNT        ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_DAY_AMOUNT        ,
								(select sum(sum_1.U_DAY_PREMIUM       ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_DAY_PREMIUM       ,
								(select sum(sum_1.U_DAY_FEE           ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_DAY_FEE           ,
								(select sum(sum_1.U_MONTH_COUNT       ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_MONTH_COUNT       ,
								(select sum(sum_1.U_MONTH_AMOUNT      ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_MONTH_AMOUNT      ,
								(select sum(sum_1.U_MONTH_PREMIUM     ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_MONTH_PREMIUM     ,
								(select sum(sum_1.U_MONTH_FEE         ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_MONTH_FEE         ,
								(select sum(sum_1.U_YEAR_COUNT        ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_YEAR_COUNT        ,
								(select sum(sum_1.U_YEAR_AMOUNT       ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_YEAR_AMOUNT       ,
								(select sum(sum_1.U_YEAR_PREMIUM      ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_YEAR_PREMIUM      ,
								(select sum(sum_1.U_YEAR_FEE          ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = #term_date# and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_YEAR_FEE          ,
								 b.branch_name org_name,
								 b.branch_id org_id
							from cpy_branch b where b.branch_level = '1'
		                     
		               ) a
		          left join (


		          select 
					(select sum(sum_1.G_DAY_COUNT         ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_DAY_COUNT         ,
					(select sum(sum_1.G_DAY_AMOUNT        ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_DAY_AMOUNT        ,
					(select sum(sum_1.G_DAY_PREMIUM       ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_DAY_PREMIUM       ,
					(select sum(sum_1.G_DAY_FEE           ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_DAY_FEE           ,
					(select sum(sum_1.G_MONTH_COUNT       ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_MONTH_COUNT       ,
					(select sum(sum_1.G_MONTH_AMOUNT      ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_MONTH_AMOUNT      ,
					(select sum(sum_1.G_MONTH_PREMIUM     ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_MONTH_PREMIUM     ,
					(select sum(sum_1.G_MONTH_FEE         ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_MONTH_FEE         ,
					(select sum(sum_1.G_YEAR_COUNT        ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_YEAR_COUNT        ,
					(select sum(sum_1.G_YEAR_AMOUNT       ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_YEAR_AMOUNT       ,
					(select sum(sum_1.G_YEAR_PREMIUM      ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_YEAR_PREMIUM      ,
					(select sum(sum_1.G_YEAR_FEE          ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) G_YEAR_FEE          ,
					(select sum(sum_1.U_DAY_COUNT         ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_DAY_COUNT         ,
					(select sum(sum_1.U_DAY_AMOUNT        ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_DAY_AMOUNT        ,
					(select sum(sum_1.U_DAY_PREMIUM       ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_DAY_PREMIUM       ,
					(select sum(sum_1.U_DAY_FEE           ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_DAY_FEE           ,
					(select sum(sum_1.U_MONTH_COUNT       ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_MONTH_COUNT       ,
					(select sum(sum_1.U_MONTH_AMOUNT      ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_MONTH_AMOUNT      ,
					(select sum(sum_1.U_MONTH_PREMIUM     ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_MONTH_PREMIUM     ,
					(select sum(sum_1.U_MONTH_FEE         ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_MONTH_FEE         ,
					(select sum(sum_1.U_YEAR_COUNT        ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_YEAR_COUNT        ,
					(select sum(sum_1.U_YEAR_AMOUNT       ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_YEAR_AMOUNT       ,
					(select sum(sum_1.U_YEAR_PREMIUM      ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_YEAR_PREMIUM      ,
					(select sum(sum_1.U_YEAR_FEE          ) g_day_count  from pro_bc_org_sum sum_1  where sum_1.date_flag = 'M' and sum_1.term_date = add_months(#term_date#, -12) and sum_1.channel_no in (select ind_branch.channelcode   from sys_branch ind_branch Start With ind_branch.branch_id = #branch_id# Connect By Prior ind_branch.branch_id = ind_branch.branch_parentid ) and sum_1.org_id in (select cpy_branch_com.branch_id  from cpy_branch cpy_branch_com Start With cpy_branch_com.branch_id = b.branch_id Connect By Prior cpy_branch_com.branch_id = cpy_branch_com.branch_parentid)) U_YEAR_FEE          ,
					 b.branch_name org_name,
					 b.branch_id org_id
				from cpy_branch b where b.branch_level = '1'

		                      ) k
		            on  k.org_id=a.org_id
		        )
 		group by org_name,org_id
    </sql>
    
    <!--查询保险公司报表所有信息-->
	<select id="querycpybranchcommission" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		<include refid="query_head"/>
		<include refid="query_allcpybranch"/>
		<include refid="query_foot"/>
	</select>
	
	<!-- 查询保险公司报表页数 -->
	<select id="cpybranchcommissioncount" parameterClass="sysbranchcommissionimpl" resultClass="int">
		select count(*) from (
		<include refid="query_allcpybranch"/>
		)
	</select>
	
	<!--查询保险公司汇总-->
	<select id="collectcpybranch" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		<include refid="query_cityallhead"/>
		<include refid="query_allcpybranch"/>
		<include refid="query_cityallfoot"/>
	</select>
	
	<!--查询保险公司下载-->
	<select id="downloadcpybranchcommission" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		<include refid="query_allcpybranch"/>
	</select>
	
	
	
	
	 <!--查询保险公司报表所有信息-->
	<select id="querycpybranch_monthcommission" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		<include refid="query_head"/>
		<include refid="query_allcpybranch_month"/>
		<include refid="query_foot"/>
	</select>
	
	<!-- 查询保险公司报表页数 -->
	<select id="cpybranch_monthcommissioncount" parameterClass="sysbranchcommissionimpl" resultClass="int">
		select count(*) from (
		<include refid="query_allcpybranch_month"/>
		)
	</select>
	
	<!--查询保险公司汇总-->
	<select id="collectcpybranch_month" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		<include refid="query_cityallhead"/>
		<include refid="query_allcpybranch_month"/>
		<include refid="query_cityallfoot"/>
	</select>
	
	<!--查询保险公司下载-->
	<select id="downloadcpybranch_monthcommission" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		<include refid="query_allcpybranch_month"/>
	</select>
	<select id="queryCpyBranch" parameterClass="sysbranchcommissionimpl" resultClass="String">
		select branch_id from cpy_branch where status = '1' and branch_level = '1' and (ins_type = 'P' or ins_type is null)order by branch_id
	</select>
	<select id="querySysbranchLevel" parameterClass="sysbranchcommissionimpl" resultClass="int">
		select branch_level from sys_branch where status = '1' and branch_id = #branch_id#
	</select>
	
	<select id="collectinsurance_sum" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		select <!--insurance_type_no,insurance_type_name branch_name, channel_no, -->
		       sum(g_day_count) g_day_count,sum(g_day_amount) g_day_amount,
		       sum(g_day_premium) g_day_premium,sum(g_day_fee) g_day_fee,
		       
		       case when trunc(sum(newg_day_premium), 2) > 0 then '+' || trunc(sum(newg_day_premium), 2)
		       		when trunc(sum(newg_day_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_day_premium), 2)
		        	end newg_day_premium,
		       case when trunc(sum(newg_day_fee), 2) > 0 then '+' || trunc(sum(newg_day_fee), 2) 
		       		when trunc(sum(newg_day_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_day_fee), 2)
		       		end newg_day_fee,
		       
		       sum(g_month_count) g_month_count, sum(g_month_amount) g_month_amount,
		       sum(g_month_premium) g_month_premium, sum(g_month_fee) g_month_fee,
		       
		       case when trunc(sum(newg_month_premium), 2) > 0 then '+' || trunc(sum(newg_month_premium), 2) 
		       		when trunc(sum(newg_month_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_month_premium), 2)
		       		end newg_month_premium,
		       case when trunc(sum(newg_month_fee), 2) > 0 then '+' || trunc(sum(newg_month_fee), 2) 
		       		when trunc(sum(newg_month_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_month_fee), 2)
		       		end newg_month_fee,
		       
		       sum(g_year_count) g_year_count, sum(g_year_amount) g_year_amount,
		       sum(g_year_premium) g_year_premium, sum(g_year_fee) g_year_fee,
		       
		       case when trunc(sum(newg_year_premium), 2) > 0 then '+' || trunc(sum(newg_year_premium), 2) 
		       		when trunc(sum(newg_year_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_year_premium), 2)
		       		end newg_year_premium,
		       case when trunc(sum(newg_year_fee), 2) > 0 then '+' || trunc(sum(newg_year_fee), 2) 
		       		when trunc(sum(newg_year_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newg_year_fee), 2)
		       		end newg_year_fee,
		       
		       sum(u_day_count) u_day_count, sum(u_day_amount) u_day_amount,
		       sum(u_day_premium) u_day_premium, sum(u_day_fee) u_day_fee,
		       
		       case when trunc(sum(newu_day_premium), 2) > 0 then '+' || trunc(sum(newu_day_premium), 2) 
		       		when trunc(sum(newu_day_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_day_premium), 2)
		       		end newu_day_premium,
		       case when trunc(sum(newu_day_fee), 2) > 0 then '+' || trunc(sum(newu_day_fee), 2) 
		       		when trunc(sum(newu_day_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_day_fee), 2)
		       		end newu_day_fee,
		       
		       sum(u_month_count) u_month_count, sum(u_month_amount) u_month_amount,
		       sum(u_month_premium) u_month_premium, sum(u_month_fee) u_month_fee,
		       
		       case when trunc(sum(newu_month_premium), 2) > 0 then '+' || trunc(sum(newu_month_premium), 2) 
		       		when trunc(sum(newu_month_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_month_premium), 2)
		       		end newu_month_premium,
		       case when trunc(sum(newu_month_fee), 2) > 0 then '+' || trunc(sum(newu_month_fee), 2) 
		       		when trunc(sum(newu_month_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_month_fee), 2)
		       		end newu_month_fee,
		       
		       sum(u_year_count) u_year_count, sum(u_year_amount) u_year_amount,
		       sum(u_year_premium) u_year_premium, sum(u_year_fee) u_year_fee,
		       
		       case when trunc(sum(newu_year_premium), 2) > 0 then '+' || trunc(sum(newu_year_premium), 2) 
		       		when trunc(sum(newu_year_premium), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_year_premium), 2)
		       		end newu_year_premium,
		       case when trunc(sum(newu_year_fee), 2) > 0 then '+' || trunc(sum(newu_year_fee), 2) 
		       		when trunc(sum(newu_year_fee), 2) = 0 then '0'
		       		else '' || trunc(sum(newu_year_fee), 2)
		       		end newu_year_fee
		  from (
		         select a.insurance_type_name,a.insurance_type_no,a.channel_no,
		                a.g_day_count,a.g_day_amount,a.g_day_premium,a.g_day_fee,
		                a.g_day_premium - nvl(k.g_day_premium, 0) newg_day_premium,
		                a.g_day_fee - nvl(k.g_day_fee, 0) newg_day_fee,
		                a.g_month_count,a.g_month_amount,a.g_month_premium,a.g_month_fee,
		                a.g_month_premium - nvl(k.g_month_premium, 0) newg_month_premium,
		                a.g_month_fee - nvl(k.g_month_fee, 0) newg_month_fee,
		                a.g_year_count,a.g_year_amount,a.g_year_premium,a.g_year_fee,
		                a.g_year_premium - nvl(k.g_year_premium, 0) newg_year_premium,
		                a.g_year_fee - nvl(k.g_year_fee, 0) newg_year_fee,
		                a.u_day_count,a.u_day_amount,a.u_day_premium,a.u_day_fee,
		                a.u_day_premium - nvl(k.u_day_premium, 0) newu_day_premium,
		                a.u_day_fee - nvl(k.u_day_fee, 0) newu_day_fee,
		                a.u_month_count,a.u_month_amount,a.u_month_premium,a.u_month_fee,
		                a.u_month_premium - nvl(k.u_month_premium, 0) newu_month_premium,
		                a.u_month_fee - nvl(k.u_month_fee, 0) newu_month_fee,
		                a.u_year_count,a.u_year_amount,a.u_year_premium,a.u_year_fee,
		                a.u_year_premium - nvl(k.u_year_premium, 0) newu_year_premium,
		                a.u_year_fee - nvl(k.u_year_fee, 0) newu_year_fee
		          from (select * from pro_bc_insurance_sum
		                  where 1=1
		                  	<isNotEmpty prepend="and" property="term_date">
								term_date = #term_date#
					 		</isNotEmpty>
					 		<isEmpty prepend="and" property="term_date">
				          		term_date = sysdate
			          		</isEmpty>
		                    and channel_no in
		                        (select channelcode from sys_branch
		                          where channelcode is not null start with branch_id = #branch_id#
		                         connect by branch_parentid = prior branch_id
		                         <!-- <isEqual property="branch_id" compareValue="3702">
						        	union all
						        	select channelcode from sys_branch where branch_id='0111'
						         </isEqual> -->
		                         )
		               ) a
		          left join (select g_day_premium,g_day_fee,
		                            g_month_premium,g_month_fee,
		                            g_year_premium,g_year_fee,
		                            u_day_premium,u_day_fee,
		                            u_month_premium,u_month_fee,
		                            u_year_premium,u_year_fee,
		                            channel_no,insurance_type_no
		                       from pro_bc_insurance_sum
		                      where 1=1
		                      	<isNotEmpty prepend="and" property="term_date">
									term_date = add_months(#term_date#, -12)
						 		</isNotEmpty>
						 		<isEmpty prepend="and" property="term_date">
					          		term_date = add_months(sysdate, -12)
				          		</isEmpty>
				          		and channel_no in
		                        (select channelcode from sys_branch
		                          where channelcode is not null start with branch_id = #branch_id#
		                         connect by branch_parentid = prior branch_id
		                         <!-- <isEqual property="branch_id" compareValue="3702">
						        	union all
						        	select channelcode from sys_branch where branch_id='0111'
						         </isEqual> -->
		                         )
		                      ) k
		            on k.channel_no = a.channel_no
		           and k.insurance_type_no = a.insurance_type_no
		           where 1=1 and a.channel_no in (SELECT channelcode
                          FROM (SELECT DISTINCT branch_id       id,
                                                branch_name     name,
                                                branch_parentid pid,
                                                channelcode
                                  FROM sys_branch t
                                 WHERE t.status = '1'
                                 START WITH t.branch_id IN
                                            (SELECT tda.data_auth_no
                                               FROM t_data_auth tda
                                              WHERE tda.is_half_check IS NULL
                                                AND tda.object_no = #createUser#
                                                AND object_type = 'USER')
                                CONNECT BY PRIOR t.branch_id = branch_parentid))

		        )
 		<!--group by insurance_type_no, insurance_type_name, channel_no -->
	</select>
	<select id="queryBranchId" parameterClass="sysbranchcommissionimpl" resultClass="String">
		select branch_id from sys_branch where status = '1' and branch_parentid = #branch_id# and branch_level = #branch_level# and status = '1' order by branch_id
	</select>
	
	<select id="downloadcpybranchcommission1" parameterClass="sysbranchcommissionimpl" resultClass="sysbranchcommissionimpl">
		select branch_name,
       branch_id org_id,
       nvl(sum(g_day_count),0) g_day_count,
       nvl(sum(g_day_amount),0) g_day_amount,
       nvl(sum(g_day_premium),0) g_day_premium,
       nvl(sum(g_day_fee),0) g_day_fee,
       case
         when trunc(sum(newg_day_premium), 2) > 0 then
          '+' || trunc(sum(newg_day_premium), 2)
         when trunc(sum(newg_day_premium), 2) = 0 then
          '0'
         else
          '' || nvl(trunc(sum(newg_day_premium), 2),0)
       end newg_day_premium,
       case
         when trunc(sum(newg_day_fee), 2) > 0 then
          '+' || trunc(sum(newg_day_fee), 2)
         when trunc(sum(newg_day_fee), 2) = 0 then
          '0'
         else
          '' || nvl(trunc(sum(newg_day_fee), 2),0)
       end newg_day_fee,
       nvl(sum(g_month_count),0) g_month_count,
       nvl(sum(g_month_amount),0) g_month_amount,
       nvl(sum(g_month_premium),0) g_month_premium,
       nvl(sum(g_month_fee),0) g_month_fee,
       case
         when trunc(sum(newg_month_premium), 2) > 0 then
          '+' || trunc(sum(newg_month_premium), 2)
         when trunc(sum(newg_month_premium), 2) = 0 then
          '0'
         else
          '' || nvl(trunc(sum(newg_month_premium), 2),0)
       end newg_month_premium,
       case
         when trunc(sum(newg_month_fee), 2) > 0 then
          '+' || trunc(sum(newg_month_fee), 2)
         when trunc(sum(newg_month_fee), 2) = 0 then
          '0'
         else
          '' || nvl(trunc(sum(newg_month_fee), 2),0)
       end newg_month_fee,
       nvl(sum(g_year_count),0) g_year_count,
       nvl(sum(g_year_amount),0) g_year_amount,
       nvl(sum(g_year_premium),0) g_year_premium,
       nvl(sum(g_year_fee),0) g_year_fee,
       case
         when trunc(sum(newg_year_premium), 2) > 0 then
          '+' || trunc(sum(newg_year_premium), 2)
         when trunc(sum(newg_year_premium), 2) = 0 then
          '0'
         else
          '' || nvl(trunc(sum(newg_year_premium), 2),0) 
       end newg_year_premium,
       case
         when trunc(sum(newg_year_fee), 2) > 0 then
          '+' || trunc(sum(newg_year_fee), 2)
         when trunc(sum(newg_year_fee), 2) = 0 then
          '0'
         else
          '' || nvl(trunc(sum(newg_year_fee), 2),0) 
       end newg_year_fee,
       nvl(sum(u_day_count),0) u_day_count,
       nvl(sum(u_day_amount),0) u_day_amount,
       nvl(sum(u_day_premium),0) u_day_premium,
       nvl(sum(u_day_fee),0) u_day_fee,
       case
         when trunc(sum(newu_day_premium), 2) > 0 then
          '+' || trunc(sum(newu_day_premium), 2)
         when trunc(sum(newu_day_premium), 2) = 0 then
          '0'
         else
          '' || nvl(trunc(sum(newu_day_premium), 2),0) 
       end newu_day_premium,
       case
         when trunc(sum(newu_day_fee), 2) > 0 then
          '+' || trunc(sum(newu_day_fee), 2)
         when trunc(sum(newu_day_fee), 2) = 0 then
          '0'
         else
          '' || nvl(trunc(sum(newu_day_fee), 2),0) 
       end newu_day_fee,
       nvl(sum(u_month_count),0) u_month_count,
       nvl(sum(u_month_amount),0) u_month_amount,
       nvl(sum(u_month_premium),0) u_month_premium,
       nvl(sum(u_month_fee),0) u_month_fee,
       case
         when trunc(sum(newu_month_premium), 2) > 0 then
          '+' || trunc(sum(newu_month_premium), 2)
         when trunc(sum(newu_month_premium), 2) = 0 then
          '0'
         else
          '' || nvl(trunc(sum(newu_month_premium), 2),0)
       end newu_month_premium,
       case
         when trunc(sum(newu_month_fee), 2) > 0 then
          '+' || trunc(sum(newu_month_fee), 2)
         when trunc(sum(newu_month_fee), 2) = 0 then
          '0'
         else
          '' || nvl(trunc(sum(newu_month_fee), 2),0)
       end newu_month_fee,
       nvl(sum(u_year_count),0) u_year_count,
       nvl(sum(u_year_amount),0) u_year_amount,
       nvl(sum(u_year_premium),0) u_year_premium,
       nvl(sum(u_year_fee),0) u_year_fee,
       case
         when trunc(sum(newu_year_premium), 2) > 0 then
          '+' || trunc(sum(newu_year_premium), 2)
         when trunc(sum(newu_year_premium), 2) = 0 then
          '0'
         else
          '' || nvl(trunc(sum(newu_year_premium), 2),0)
       end newu_year_premium,
       case
         when trunc(sum(newu_year_fee), 2) > 0 then
          '+' || trunc(sum(newu_year_fee), 2)
         when trunc(sum(newu_year_fee), 2) = 0 then
          '0'
         else
          '' || nvl(trunc(sum(newu_year_fee), 2),0)
       end newu_year_fee
  from (select a.g_day_count,
               a.g_day_amount,
               a.g_day_premium,
               a.g_day_fee,
               a.g_day_premium - nvl(k.g_day_premium, 0) newg_day_premium,
               a.g_day_fee - nvl(k.g_day_fee, 0) newg_day_fee,
               a.g_month_count,
               a.g_month_amount,
               a.g_month_premium,
               a.g_month_fee,
               a.g_month_premium - nvl(k.g_month_premium, 0) newg_month_premium,
               a.g_month_fee - nvl(k.g_month_fee, 0) newg_month_fee,
               a.g_year_count,
               a.g_year_amount,
               a.g_year_premium,
               a.g_year_fee,
               a.g_year_premium - nvl(k.g_year_premium, 0) newg_year_premium,
               a.g_year_fee - nvl(k.g_year_fee, 0) newg_year_fee,
               a.u_day_count,
               a.u_day_amount,
               a.u_day_premium,
               a.u_day_fee,
               a.u_day_premium - nvl(k.u_day_premium, 0) newu_day_premium,
               a.u_day_fee - nvl(k.u_day_fee, 0) newu_day_fee,
               a.u_month_count,
               a.u_month_amount,
               a.u_month_premium,
               a.u_month_fee,
               a.u_month_premium - nvl(k.u_month_premium, 0) newu_month_premium,
               a.u_month_fee - nvl(k.u_month_fee, 0) newu_month_fee,
               a.u_year_count,
               a.u_year_amount,
               a.u_year_premium,
               a.u_year_fee,
               a.u_year_premium - nvl(k.u_year_premium, 0) newu_year_premium,
               a.u_year_fee - nvl(k.u_year_fee, 0) newu_year_fee
          from (select sum(sum_1.G_DAY_COUNT) G_DAY_COUNT,
                       sum(sum_1.G_DAY_AMOUNT) G_DAY_AMOUNT,
                       sum(sum_1.G_DAY_PREMIUM) G_DAY_PREMIUM,
                       sum(sum_1.G_DAY_FEE) G_DAY_FEE,
                       sum(sum_1.G_MONTH_COUNT) G_MONTH_COUNT,
                       sum(sum_1.G_MONTH_AMOUNT) G_MONTH_AMOUNT,
                       sum(sum_1.G_MONTH_PREMIUM) G_MONTH_PREMIUM,
                       sum(sum_1.G_MONTH_FEE) G_MONTH_FEE,
                       sum(sum_1.G_YEAR_COUNT) G_YEAR_COUNT,
                       sum(sum_1.G_YEAR_AMOUNT) G_YEAR_AMOUNT,
                       sum(sum_1.G_YEAR_PREMIUM) G_YEAR_PREMIUM,
                       sum(sum_1.G_YEAR_FEE) G_YEAR_FEE,
                       sum(sum_1.U_DAY_COUNT) U_DAY_COUNT,
                       sum(sum_1.U_DAY_AMOUNT) U_DAY_AMOUNT,
                       sum(sum_1.U_DAY_PREMIUM) U_DAY_PREMIUM,
                       sum(sum_1.U_DAY_FEE) U_DAY_FEE,
                       sum(sum_1.U_MONTH_COUNT) U_MONTH_COUNT,
                       sum(sum_1.U_MONTH_AMOUNT) U_MONTH_AMOUNT,
                       sum(sum_1.U_MONTH_PREMIUM) U_MONTH_PREMIUM,
                       sum(sum_1.U_MONTH_FEE) U_MONTH_FEE,
                       sum(sum_1.U_YEAR_COUNT) U_YEAR_COUNT,
                       sum(sum_1.U_YEAR_AMOUNT) U_YEAR_AMOUNT,
                       sum(sum_1.U_YEAR_PREMIUM) U_YEAR_PREMIUM,
                       sum(sum_1.U_YEAR_FEE) U_YEAR_FEE
                  from pro_bc_org_sum sum_1
                  where sum_1.date_flag = 'D'
                   and sum_1.term_date = #term_date#
                   and sum_1.channel_no in
                       (SELECT channelcode
                          FROM (SELECT DISTINCT branch_id       id,
                                                branch_name     name,
                                                branch_parentid pid,
                                                channelcode
                                  FROM sys_branch t
                                 WHERE t.status = '1'
                                 START WITH t.branch_id IN
                                            (SELECT tda.data_auth_no
                                               FROM t_data_auth tda
                                              WHERE tda.is_half_check IS NULL
                                                AND tda.object_no =  #createUser#
                                                AND object_type = 'USER')
                                CONNECT BY PRIOR t.branch_id = branch_parentid))
                   and sum_1.channel_no in
                       (select ind_branch.channelcode
                          from sys_branch ind_branch
                         where ind_branch.status = '1'
                         Start With ind_branch.branch_id =  #branch_id#
                        Connect By Prior ind_branch.branch_id =
                                    ind_branch.branch_parentid)
                  and sum_1.org_id =  #cpy_branch_id# ) a,
                  (select sum(sum_1.G_DAY_COUNT) G_DAY_COUNT,
                           sum(sum_1.G_DAY_AMOUNT) G_DAY_AMOUNT,
                           sum(sum_1.G_DAY_PREMIUM) G_DAY_PREMIUM,
                           sum(sum_1.G_DAY_FEE) G_DAY_FEE,
                           sum(sum_1.G_MONTH_COUNT) G_MONTH_COUNT,
                           sum(sum_1.G_MONTH_AMOUNT) G_MONTH_AMOUNT,
                           sum(sum_1.G_MONTH_PREMIUM) G_MONTH_PREMIUM,
                           sum(sum_1.G_MONTH_FEE) G_MONTH_FEE,
                           sum(sum_1.G_YEAR_COUNT) G_YEAR_COUNT,
                           sum(sum_1.G_YEAR_AMOUNT) G_YEAR_AMOUNT,
                           sum(sum_1.G_YEAR_PREMIUM) G_YEAR_PREMIUM,
                           sum(sum_1.G_YEAR_FEE) G_YEAR_FEE,
                           sum(sum_1.U_DAY_COUNT) U_DAY_COUNT,
                           sum(sum_1.U_DAY_AMOUNT) U_DAY_AMOUNT,
                           sum(sum_1.U_DAY_PREMIUM) U_DAY_PREMIUM,
                           sum(sum_1.U_DAY_FEE) U_DAY_FEE,
                           sum(sum_1.U_MONTH_COUNT) U_MONTH_COUNT,
                           sum(sum_1.U_MONTH_AMOUNT) U_MONTH_AMOUNT,
                           sum(sum_1.U_MONTH_PREMIUM) U_MONTH_PREMIUM,
                           sum(sum_1.U_MONTH_FEE) U_MONTH_FEE,
                           sum(sum_1.U_YEAR_COUNT) U_YEAR_COUNT,
                           sum(sum_1.U_YEAR_AMOUNT) U_YEAR_AMOUNT,
                           sum(sum_1.U_YEAR_PREMIUM) U_YEAR_PREMIUM,
                           sum(sum_1.U_YEAR_FEE) U_YEAR_FEE
                      from pro_bc_org_sum sum_1
                      where sum_1.date_flag = 'D'
                       and sum_1.term_date = add_months( #term_date#, -12)
                       and sum_1.channel_no in
                           (SELECT channelcode
                              FROM (SELECT DISTINCT branch_id       id,
                                                    branch_name     name,
                                                    branch_parentid pid,
                                                    channelcode
                                      FROM sys_branch t
                                     WHERE t.status = '1'
                                     START WITH t.branch_id IN
                                                (SELECT tda.data_auth_no
                                                   FROM t_data_auth tda
                                                  WHERE tda.is_half_check IS NULL
                                                    AND tda.object_no =  #createUser#
                                                    AND object_type = 'USER')
                                    CONNECT BY PRIOR
                                                t.branch_id = branch_parentid))
                       and sum_1.channel_no in
                           (select ind_branch.channelcode
                              from sys_branch ind_branch
                             where ind_branch.status = '1'
                             Start With ind_branch.branch_id =  #branch_id#
                            Connect By Prior ind_branch.branch_id =
                                        ind_branch.branch_parentid)
                       and sum_1.org_id =  #cpy_branch_id# ) k),(select branch_id,branch_name from cpy_branch where status = '1' and branch_id =  #cpy_branch_id#)
                       group by branch_id,branch_name
	</select>
	<select id="queryInsBranchLevel" parameterClass="sysbranchcommissionimpl" resultClass="int">
		select branch_level from cpy_branch where status = '1' and branch_id = #cpy_branch_id#
	</select>
	<select id="queryCpyBranchId" parameterClass="sysbranchcommissionimpl" resultClass="String">
		select branch_id from cpy_branch where status = '1' and branch_parentid = #cpy_branch_id# <!-- and branch_level = #org_level# -->
	</select>
</sqlMap>
